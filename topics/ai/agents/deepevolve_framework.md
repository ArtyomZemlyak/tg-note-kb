# DeepEvolve: Фреймворк для автоматического открытия научных алгоритмов

## Общее описание

DeepEvolve - это инновационный агентный фреймворк, представленный в статье "Scientific Algorithm Discovery by Augmenting AlphaEvolve with Deep Research", который улучшает процесс открытия научных алгоритмов, объединяя глубокое исследование с эволюцией алгоритмов. Эта система расширяет эволюционный подход моделей вроде AlphaEvolve, добавляя итерационный цикл из шести модулей: планирование исследовательских вопросов, поиск во внешних базах знаний (например, arXiv, PubMed), синтез предложений, их реализация через редактирование кода в нескольких файлах, оценка производительности и отбор кандидатов для следующего раунда. Ключевой инженерный вклад - это агент-отладчик, который автоматически устраняет ошибки исполнения, значительно повышая успешность реализации сложных идей.

## Контекст: От слепой эволюции к осознанному открытию

Стремление создать ИИ-агентов, способных к автономным научным открытиям, привело к быстрому прогрессу. Системы вроде AlphaEvolve и FunSearch продемонстрировали мощь сочетания больших языковых моделей (LLM) с эволюционным поиском. Однако проявилось и критическое ограничение: полагаясь исключительно на внутренние знания LLM, эти системы, как правило, быстро достигают потолка производительности, часто выдавая свой лучший результат в первых нескольких поколениях, а затем останавливаясь на незначительных улучшениях.

Этот эффект выхода на плато подчёркивает фундаментальное ограничение эволюционного поиска, когда он руководствуется статической базой знаний. LLM попадает в "концептуальный локальный оптимум": она отлично справляется с доработкой известных техник, но с трудом совершает парадигматические сдвиги, для которых требуется новая, внешняя информация. DeepEvolve представляет фреймворк, разработанный для преодоления этого разрыва. Его фаза "глубокого исследования" действует как стратегическое вмешательство, целенаправленно вводя концепции, подтверждённые внешними источниками, чтобы вывести эволюционный поиск в более перспективные области пространства решений.

## Архитектура фреймворка

DeepEvolve воплощает идею интеграции глубоких исследований с эволюционными алгоритмами в жизнь через элегантный итерационный цикл из шести модулей, который имитирует научный процесс человека. Исходный алгоритм улучшается через повторяющиеся циклы генерации гипотез и их провалидированной реализации.

### 1. Глубокое алгоритмическое исследование (планирование, поиск, написание)

Это ключевая инновация, которая служит фундаментом для процесса открытий. Вместо того чтобы вслепую мутировать код, агент сначала формулирует план исследования. Он генерирует целевые поисковые запросы для обращения к внешним базам знаний, таким как PubMed и arXiv. Затем полученные результаты синтезируются в конкретное исследовательское предложение с псевдокодом, которое направляет последующую реализацию. Этот процесс адаптивен: на ранних стадиях он отдаёт предпочтение осуществимым идеям, а на более поздних и зрелых — стремится к более значимым, преобразующим изменениям.

### 2. Эволюция алгоритма (кодирование, оценка, отбор)

На этом этапе исследовательское предложение превращается в функциональный, протестированный алгоритм. Это становится возможным благодаря двум ключевым инженерным усовершенствованиям:

- **Редактирование кода в нескольких файлах**: В отличие от предыдущих систем, ограниченных изменениями в одном файле, кодирующий агент DeepEvolve может анализировать и вносить целенаправленные правки в кодовую базу из нескольких файлов — критически важная возможность для реализации сложных архитектурных изменений.

- **Систематическая отладка**: Признавая, что новый код часто содержит ошибки, фреймворк включает в себя отдельного агента-отладчика. Он анализирует ошибки выполнения и итеративно применяет исправления, что значительно повышает успешность превращения амбициозной идеи в рабочий код.

Наконец, новый алгоритм оценивается. Результат вместе с самим алгоритмом сохраняется в эволюционной базе данных. Эта база данных использует сложные стратегии отбора — островные популяции для выбора кандидатов и MAP-Elites для вдохновения — чтобы сбалансировать эксплуатацию высокопроизводительных решений с исследованием разнообразных и новых направлений.

## Технические детали: пример с предсказанием свойств молекул

Чтобы проиллюстрировать мощь фреймворка, рассмотрим его применение к задаче предсказания свойств молекул. Начав с базового метода рационализации графов, DeepEvolve за пять поколений произвёл серию улучшений, завершившись созданием нового сложного алгоритма. Итоговая модель интегрирует несколько передовых техник, обнаруженных в ходе глубокого исследования:

- **Контрастивное обучение**: Используется лосс InfoNCE для изучения более надёжных представлений путём сравнения двух аугментированных представлений (views) молекулярного обоснования (z₁, z₂). Лосс рассчитывается с использованием L2-нормализованных эмбеддингов и кросс-энтропии по положительным и отрицательным сходствам.

- **Дифференцируемое маскирование мотивов с учётом неопределённости**: Чтобы сосредоточиться на химически значимых подструктурах (мотивах), модель выучивает динамическую адаптивную маску. Она использует дропаут Монте-Карло для оценки своей неопределённости для каждого потенциального мотива. Эта мера затем используется для интеллектуального снижения веса подструктур с высокой неопределённостью, не позволяя модели полагаться на ложные признаки и улучшая как надёжность, так и интерпретируемость. Основная логика описывается формулой:
  ```
  adaptive_mask = torch.where(
    uncertainty < threshold_uncertainty,
    mean_score,
    mean_score * (threshold_uncertainty / (uncertainty + 1e-8)),
  )
  ```

- **Восстановление в режиме self-supervised и состязательное обучение**: Итоговый алгоритм также включает в себя задачу по восстановлению замаскированных мотивов в режиме self-supervised обучения и двухфазную схему состязательного обучения для повышения надёжности.

Этот пример показывает, как DeepEvolve выходит за рамки простой настройки параметров, открывая и интегрируя сложные, методологически обоснованные улучшения.

## Экспериментальные результаты

Авторы протестировали DeepEvolve на девяти сложных научных задачах из химии, математики, биологии, материаловедения и патентного анализа, используя разнообразные типы данных, такие как молекулы, изображения, дифференциальные уравнения в частных производных и временные ряды.

### Результаты впечатляют:

- **Устойчивый рост производительности**: DeepEvolve последовательно улучшал исходные базовые алгоритмы, при этом прирост производительности варьировался от 0.39% до ошеломляющих 666.02% в задаче упаковки кругов. Этот огромный прирост был не просто оптимизацией; исходный алгоритм был хрупким и плохо обобщался, в то время как DeepEvolve открыл принципиально новый, надёжный алгоритм, который давал корректные решения в более широком диапазоне условий.

- **Улучшенное качество идей**: Оценка с использованием LLM-as-a-judge подтвердила, что алгоритмы, открытые DeepEvolve, были не только более производительными, но и получали более высокие оценки по "Оригинальности" и "Будущему потенциалу".

- **Надёжность благодаря отладке**: Агент-отладчик оказался критически важен. В задаче Open Vaccine он увеличил успешность выполнения алгоритма с всего 13% до 99%.

- **Сила исследования**: Анализ-абляция наглядно продемонстрировал необходимость компонента глубокого исследования. Без него система возвращалась к поведению чистой эволюции с выходом на плато, давая лишь незначительные улучшения. С глубоким исследованием DeepEvolve достигал более сильных улучшений за меньшее число поколений.

## Обсуждение и будущие направления

Архитектуру DeepEvolve можно рассматривать как прообраз для следующего поколения ИИ-агентов. Она представляет собой созревание от ранних монолитных агентов, которые просто дают LLM команду закодировать, к структурированным, многоэтапным фреймворкам, где LLM является компонентом в более крупном, контролируемом научном процессе. Агент не просто действует; он планирует, исследует, синтезирует, реализует, отлаживает и оценивает.

Однако работа не лишена ограничений. Фреймворк работает в рамках жёсткого 30-минутного временного бюджета, что может смещать открытия в сторону идей, которые быстро реализуются и оцениваются. Действительно, авторы отмечают, что некоторые из самых амбициозных идей, предложенных исследовательским модулем, не были успешно выполнены в итоговом рабочем процессе.

## Заключение

DeepEvolve представляет надёжный и обобщаемый фреймворк для открытия научных алгоритмов. Дополняя эволюцию алгоритмов глубоким исследованием, основанным на внешних данных, DeepEvolve демонстрирует ясный путь к созданию ИИ-агентов, способных достигать устойчивых, нетривиальных успехов в науке. Работа убедительно показывает, что будущее научных открытий с помощью ИИ заключается не в том, чтобы рассматривать LLM как изолированные оптимизаторы-чёрные ящики, а в том, чтобы дать им возможность стать активными участниками глобального научного диалога — читая, рассуждая и опираясь на коллективные знания человечества.

## Связи с другими темами

- [[ai/optimization/evolutionary_algorithms.md]] - основы эволюционных алгоритмов, которые DeepEvolve расширяет и улучшает
- [[ai/agents/alphaevolve_system.md]] - предшествующая система, которую DeepEvolve улучшает путем добавления глубоких исследований
- [[ai/agents/funsearch_system.md]] - альтернативная система для автоматического открытия алгоритмов
- [[ai/agents/code_agents/sgr_code_agent.md]] - возможности ИИ-агентов для работы с кодом, схожие с компонентом редактирования кода в DeepEvolve
- [[ai/llm/applications/llm_scientific_research.md]] - применение языковых моделей в научных исследованиях, часть подхода DeepEvolve
- [[ai/optimization/combinatorial_optimization.md]] - область, в которой DeepEvolve продемонстрировал впечатляющие результаты
- [[ai/optimization/gigaevo_framework.md]] - современный фреймворк, также объединяющий эволюционные алгоритмы с LLM для автоматической эволюции программ
- [[ai/agents/multi_model_orchestrators.md]] - фреймворки для координации нескольких ИИ-моделей, подобно шестиступенчатому процессу DeepEvolve