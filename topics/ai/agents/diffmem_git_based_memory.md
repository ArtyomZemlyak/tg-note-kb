# DiffMem: Git-Based Memory for AI Agents

## Краткое описание

DiffMem - это легковесная, основанная на Git системе памяти, разработанная для ИИ-агентов и conversational систем. Проект использует файлы Markdown для хранения данных в удобочитаемом формате и Git для отслеживания временной эволюции через дифференциалы (differentials). Это инновационное решение, которое соединяет принципы систем контроля версий с эффективной памятью ИИ-агентов.

## Основные особенности

### 1. Акцент на текущем состоянии
- Файлы памяти хранят только текущее ("теперьшнее") представление информации
- Исторические состояния сохраняются в истории Git
- Позволяет агентам быстро получать актуальную информацию

### 2. Дифференциальный интеллект
- Использует Git diff и логи для отслеживания изменения памяти со временем
- Позволяет анализировать эволюцию знаний и информации
- Обеспечивает прозрачность изменений в системе памяти

### 3. Прочность и переносимость
- Использование Plaintext Markdown обеспечивает удобочитаемые, инструмент-независимые данные
- Поддержка гибкости и портативности данных
- Легкая интеграция без необходимости в отдельных серверах

### 4. Эффективность
- Разделение "поверхности" (текущие файлы) от "глубины" (история Git) для избирательной загрузки
- Обеспечивает быстрый и объяснимый поиск с помощью индекса BM25
- Встроенный индекс BM25 в памяти для быстрого поиска

### 5. Multi-Depth Context Assembly
- Поддерживает различные уровни контекста: basic (базовые блоки), wide (семантический поиск), deep (полные файлы), temporal (с историей Git)

### 6. Temporal Queries
- Может получать доступ к историческим состояниям через Git commit history

## Архитектурные компоненты

### Writer Agent
- Анализирует транскрипты разговоров
- Определяет и фиксирует обновления в системе памяти
- Отвечает за обновление текущего состояния знаний
- Использует явные коммиты Git для обеспечения атомарности изменений

### Context Manager
- Собирает релевантный контекст с различной глубиной
- Управляет доступом к информации разного уровня детализации
- Обеспечивает эффективную работу с историческими данными
- Поддерживает базовый, широкий, глубокий и временной контекст

### Searcher Agent
- Управляемый LLM агент поиска
- Использует оркестрацию с помощью больших языковых моделей
- Обеспечивает точный и контекстуальный поиск
- Синтезирует BM25 поисковые запросы из разговоров

### API Layer
- Чистый интерфейс для операций чтения и записи
- Обеспечивает стандартизированный доступ к системе памяти
- Поддерживает интеграцию с различными ИИ-агентами

## Технические детали

### Технологии
- **Язык программирования**: Python 3.11+
- **Хранение данных**: Markdown-файлы для удобочитаемого хранения
- **Контроль версий**: Git для отслеживания изменений
- **Поиск**: BM25 индексация для быстрого и объяснимого поиска
- **Формат данных**: Plaintext для совместимости и переносимости
- **Зависимости**: gitpython, rank-bm25, sentence-transformers

### Архитектурный подход
- Разделяет "поверхность" (текущие файлы) от "глубины" (история Git)
- Текущее состояние знаний хранится в редактируемых Markdown файлах
- Исторические изменения сохраняются в графе коммитов Git
- Позволяет агентам запрашивать компактную, актуальную поверхность без оверхеда исторических данных
- Исторические данные остаются доступными по требованию через историю Git

### Преимущества подхода
- Прозрачность: все изменения сохраняются в Git с понятной историей
- Масштабируемость: поддержка больших объемов данных через Git
- Совместимость: легко интегрируется с существующими Git-процессами
- Надежность: проверенная система контроля версий для сохранности данных
- Доступность: не требует серверов, работает как импортируемые модули

## Пример использования

```python
from diffmem import DiffMemory

memory = DiffMemory("/path/to/repo", "alex", "your-api-key")

# Получить контекст для разговора
context = memory.get_context(conversation, depth="deep")

# Обработать и зафиксировать новую память
memory.process_and_commit_session("Had coffee with mom today...", "session-123")
```

## Статус и ограничения

### Текущее состояние
- Проект Proof-of-Concept (PoC)
- Функционально, но не до конца проработано для продакшена
- Лицензия MIT, открытое участие в разработке
- Рабочие функции: создание/обновление сущностей из транскриптов, сборка контекста на разных уровнях, гибридный семантический/BM25 поиск, временные запросы через Git

### Известные ограничения
- Нет автоматической синхронизации Git (требуются ручные pull/push операции)
- Базовая обработка ошибок
- Отсутствие блокировок конкуренции для нескольких пользователей
- Индекс пересобирается при каждой инициализации (необходимо кэширование для продакшена)
- Проект в стадии активной разработки

## Будущее видение

### Агент-ориентированная очистка
- LLM, которые "забывают" низкоценные воспоминания, архивируя их в ветки Git

### Совместные воспоминания
- Многоагентные системы, обменивающиеся репозиториями с merge request для "примирения памяти"

### Временные агенты
- Специализированные модели, которые запрашивают логи Git, чтобы отвечать на вопросы "как я изменился?"

### Гибридные хранилища
- Комбинация с векторными вложениями для семантической глубины при использовании Git как "дифф-слоя"

### Экосистема с открытым исходным кодом
- Плагины для голосового ввода, мобильной синхронизации или интеграции с инструментами вроде Obsidian

## Применение

DiffMem особенно полезен для:
- Долгосрочных взаимодействий ИИ-агентов
- Систем, требующих прозрачности изменений
- Приложений, где важна история изменений знаний
- Сценариев, где требуется сочетание текущего состояния и исторических данных
- Conversational AI систем с длительными сессиями

## Связь с другими темами

- [[memory_systems_for_ai_agents.md]] - Общие системы памяти для ИИ-агентов
- [[git_based_memory_systems.md]] - Git-ориентированные системы памяти для ИИ-агентов
- [[../../programming/software_architecture/version_control_systems.md]] - Системы контроля версий
- [[../../programming/software_architecture/git_synchronization_errors.md]] - Ошибки синхронизации Git: решения проблем с несохраненными изменениями
- [[../../programming/software_architecture/bm25_search_algorithm.md]] - Алгоритм поиска BM25