# Promptable Concept Segmentation (PCS) - Сегментация по запросу понятий

## Определение

Promptable Concept Segmentation (PCS) — это новая парадигма в компьютерном зрении, представленная с выходом модели SAM 3. В отличие от традиционных методов сегментации, PCS позволяет пользователям указывать нужные объекты с помощью текстовых промптов (например, "корабль", "дерево") или примеров изображений, после чего модель находит и сегментирует все экземпляры этого понятия на изображении или во всех кадрах видео.

## Особенности PCS

### Свободная онтология
- PCS не ограничивается предопределенным набором классов
- Модель может сегментировать практически любые визуальные понятия, которые можно описать текстом или показать в примере
- Работает с редкими и необычными объектами, которые не были явно включены в обучающий датасет

### Глобальное сегментирование
- В отличие от классических методов, которые сегментируют один объект за раз, PCS может идентифицировать и сегментировать все экземпляры одного понятия одновременно
- Это особенно полезно для приложений, где нужно найти все объекты определенного типа на изображении

### Поддержка различных типов промптов
- **Текстовые промпты**: пользователи могут использовать именные фразы для описания нужных объектов
- **Визуальные примеры**: пользователи могут предоставить примеры изображений объектов, которые нужно сегментировать
- **Комбинированные промпты**: возможность комбинирования текстовых и визуальных промптов для более точной настройки

## Технические аспекты

### Архитектура для PCS
- Требует специализированных архитектур, таких как SAM 3, с отдельным «presence head» для распознавания понятий
- Необходимы большие обучающие датасеты с разнообразными понятиями и их визуальными представлениями
- Интеграция визуальных и текстовых энкодеров для понимания семантики промптов

### Метрики оценки
- **CGF1 (Concept Generalization F1)**: основная метрика для оценки производительности PCS
- **Per-Concept Segmentation (PCS)**: оценка способности модели сегментировать различные понятия
- **Zero-shot оценка**: способность модели работать с понятиями, не встречавшимися в обучающем датасете

## Применение PCS

### Области применения
- **Автоматическая разметка датасетов**: быстрая аннотация изображений с минимальным вмешательством человека
- **Контент-модерация**: идентификация специфических объектов или сцен в медиафайлах
- **Медицинская визуализация**: сегментация анатомических структур по текстовому описанию
- **Экологический мониторинг**: отслеживание видов животных и растений в видео с камер
- **Розничная автоматизация**: идентификация продуктов и товаров на изображениях

### Примеры использования
- Пользователь загружает изображение улицы и вводит "автомобиль", модель сегментирует все автомобили на изображении
- В медицинской системе пользователь вводит "опухоль", система сегментирует все потенциальные опухолевые образования на МРТ или КТ
- В промышленности пользователь указывает "дефект", система выделяет все дефектные области на изображениях продукции

## Сравнение с традиционными методами

| Аспект | Традиционная сегментация | PCS |
|--------|---------------------------|-----|
| Поддержка классов | Ограниченный набор | Открытая онтология |
| Тип промптов | Точки, боксы, маски | Текст, изображения, комбинации |
| Глобальное сегментирование | Один объект за раз | Все экземпляры сразу |
| Новые понятия | Требуется переобучение | Zero-shot способность |
| Сложность разработки | Относительно проста | Требует сложных архитектур |

## Вызовы и ограничения

### Технические вызовы
- Обработка сложных текстовых описаний, требующих рассуждений
- Обеспечение точности на редких или неоднозначных понятиях
- Баланс между скоростью и точностью при обработке больших сцен

### Практические ограничения
- Не все текстовые описания могут быть напрямую связаны с визуальными признаками
- Сложность при сегментации перекрывающихся или взаимосвязанных объектов
- Вариации в интерпретации пользовательских промптов

## Источники

1. [SAM 3: Segment Anything with Concepts - Ultralytics Documentation](https://docs.ultralytics.com/models/sam-3/) - подробная информация о PCS как ключевой функции SAM 3
2. [What Is Segment Anything 3 (SAM 3)? - Roboflow Blog](https://blog.roboflow.com/what-is-sam3/) - технический анализ PCS и его отличий от традиционных методов
3. [Meta AI Research Paper on SAM 3](https://ai.meta.com/research/publications/sam-3-segment-anything-with-concepts/) - оригинальная исследовательская статья о SAM 3 и PCS

## См. также

- [[sam_3_segment_anything_model.md]] - Описание конкретной реализации PCS в модели SAM 3
- [[generative_segmentation_as_editing.md]] - Другая парадигма сегментации в компьютерном зрении
- [[multimodal_models.md]] - Модели, объединяющие визуальные и текстовые модальности как в PCS
- [[vision_transformer.md]] - Архитектуры, лежащие в основе современных моделей сегментации