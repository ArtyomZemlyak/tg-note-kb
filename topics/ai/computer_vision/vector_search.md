# Векторный поиск и базы данных

## Общие понятия

Векторный поиск - это метод поиска, при котором данные представлены в виде векторов (массивов чисел) в многомерном пространстве. Он используется для поиска схожих объектов по их векторным представлениям.

## Векторные эмбеддинги

### Что такое эмбеддинги
- Числовые векторы, представляющие данные (изображения, текст, аудио)
- Близкие объекты в векторном пространстве соответствуют схожим данным
- Преобразуют нечисловые данные в числовую форму для машинного обучения

### Создание эмбеддингов
- С помощью нейронных сетей (например, SigLIP для изображений)
- Предварительно вычисленные для быстрого поиска
- Хранятся в векторных базах данных

## Векторные базы данных

### Что такое векторные базы данных
- Специализированные системы хранения и поиска векторных данных
- Реализуют эффективные алгоритмы ближайшего соседства
- Оптимизированы для поиска схожих элементов

### Основные функции
- Хранение векторов высокой размерности
- Поиск ближайших соседей (k-NN)
- Индексация для ускорения поиска
- Поддержка метаданных

## Qdrant

Qdrant - это векторная база данных с открытым исходным кодом, разработанная для поиска и сопоставления точек данных с векторными признаками.

### Особенности Qdrant
- Поддержка различных метрик сходства (евклидова, косинусное расстояние, скалярное произведение)
- Гибкие индексы для ускорения поиска
- Поддержка метаданных и фильтрации
- REST и gRPC API

### Архитектура Qdrant
- Коллекции с векторами и метаданными
- Поддержка HNSW индексов для быстрого поиска
- Управление точками (векторы + полезная нагрузка)

### Применение Qdrant
- Поиск по сходству с изображениями
- Рекомендательные системы
- Семантический поиск
- Дубликаты обнаружения

## HNSW (Hierarchical Navigable Small World)

HNSW - один из самых эффективных алгоритмов для поиска приближенных ближайших соседей в высокоразмерных пространствах.

### Принцип работы HNSW
- Иерархическая структура графов
- Несколько уровней навигации
- Более разреженные графы на верхних уровнях
- Более плотные графы на нижних уровнях

### Преимущества HNSW
- Высокая производительность при поиске
- Хорошее соотношение точности и скорости
- Масштабируемость на больших датасетах
- Поддержка в ведущих векторных базах данных (включая Qdrant)

### Процесс поиска в HNSW
1. Начинается с верхнего уровня графа
2. Использует жадный алгоритм для поиска ближайшего узла
3. Переходит на следующий уровень
4. Повторяет до самого нижнего уровня
5. Возвращает ближайшие векторы

## Применение в поиске по фото

### В системе Wildberries
- SigLIP-эмбеддинги товаров хранятся в Qdrant
- Загруженное пользователем фото преобразуется в эмбеддинг
- Qdrant с помощью HNSW находит ближайшие товарные эмбеддинги
- Результаты возвращаются пользователю

### Процесс:
1. Предварительное вычисление эмбеддингов товаров
2. Хранение в Qdrant с HNSW индексами
3. Преобразование загруженного фото в эмбеддинг
4. Поиск ближайших соседей в Qdrant
5. Отображение соответствующих товаров

## Другие векторные базы данных

### Weaviate
- GraphQL и REST API
- Поддержка машинного обучения
- Встроенные модули векторизации

### Pinecone
- Облачное решение
- Управляемые индексы
- Поддержка реального времени

### Milvus
- Открытый исходный код
- Высокая масштабируемость
- Поддержка различных алгоритмов

## Преимущества векторного поиска

- Семантическое понимание
- Поиск по сходству, а не точному совпадению
- Обработка неструктурированных данных
- Возможности рекомендаций

## Вызовы и ограничения

- Высокие требования к памяти
- Сложность масштабирования
- Баланс между точностью и скоростью
- Необходимость качественных эмбеддингов

## Связи с другими темами

- [[ai/computer_vision/visual_search/wildberries_photo_search.md]] - Использование Qdrant и HNSW в поиске по фото
- [[ai/computer_vision/multimodal_models.md]] - Создание векторных эмбеддингов
- [[ai/machine_learning/machine_learning.md]] - Общие понятия о машинном обучении и эмбеддингах