# Consistency Models: Прямое обучение карт решений диффузионных моделей

## Общее описание

Consistency Models - это подход к обучению генеративных моделей, который напрямую обучает быстрый, малошаговый генератор без необходимости в предобученной модели-учителе. В отличие от классических диффузионных моделей, которые требуют множество шагов для генерации, Consistency Models учатся напрямую отображать из шума в целевые данные за малое количество шагов.

## Основные принципы

### Проблема скорости классических диффузионных моделей
- Классические диффузионные модели требуют сотен шагов для генерации
- Это делает их медленными для практического использования
- Семплинг требует много вычислительных ресурсов

### Решение через обучение карт решений
- Вместо улучшения итеративного солвера, Consistency Models напрямую обучаются карте решений ОДУ, Ψₛ→ₜ
- Эта карта позволяет генерировать данные за малое количество шагов
- Модель учится напрямую преобразовывать шум в целевые данные

### Два подхода к ускорению диффузионных моделей

1. **Ускорение без обучения (улучшение солвера)**:
   - Рассматривает обученную диффузионную модель как фиксированное векторное поле
   - Фокусируется на разработке лучших численных решателей ОДУ
   - Примеры: DDIM, DEIS, DPM-Solver

2. **Ускорение на основе обучения (выучивание карты решений)**:
   - Выучивает карту решений ОДУ, Ψₛ→ₜ, напрямую
   - Consistency Models являются примером этого подхода
   - Обучаются без предобученной модели-учителя

### Свойство полугруппы для потоков ОДУ
- Ключевая идея: Ψᵤ→ₜ ∘ Ψₛ→ᵤ = Ψₛ→ₜ
- Это означает, что результат последовательности маленьких шагов должен совпадать с результатом одного большого шага
- Обеспечивает мощный self-supervised сигнал для обучения

### Self-supervised обучение
- Модель обучается так, чтобы один большой «прыжок» во времени давал тот же результат, что и последовательность маленьких
- Это позволяет модели обучать саму себя
- Устраняет необходимость в предобученной модели-учителе

## Преимущества

- **Скорость**: Генерация за малое количество шагов
- **Эффективность**: Меньше вычислительных затрат по сравнению с классическими диффузионными моделями
- **Независимость**: Не требуют предобученной модели-учителя
- **Качество**: Сохраняют качество генерации при ускорении

## Связь с единой теорией диффузионных моделей

Consistency Models тесно связаны с единой теорией диффузионных моделей:
- Они представляют следующий шаг в эволюции диффузионных моделей
- Используют понимание, полученное из объединенной математической структуры
- Позволяют обойти традиционные ограничения скорости генерации
- Основаны на понимании Probability Flow ODE и его решений

## Применения

- Генерация изображений с высоким качеством за малое количество шагов
- Генерация видео и аудио
- Генерация текста
- Синтез данных для обучения других моделей

## Связи с другими темами

- [[theory/unified_theory_of_diffusion_models.md|Единая теория диффузионных моделей]] - теоретическая основа, объясняющая, почему и как работают Consistency Models 
- [[flow_matching.md|Flow Matching]] - один из подходов, объединенных в единой теории
- [[llm/diffusion_models.md|Диффузионные модели]] - базовая технология, которую ускоряют Consistency Models
- [[llm/models/generative_models.md|Генеративные модели]] - общая категория