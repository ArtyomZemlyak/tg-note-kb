# Dreamer: Семейство агентов с моделями мира

## Общее описание

**Dreamer** — это семейство архитектур агентов с подкреплением, которые обучаются стратегии полностью внутри обученных моделей мира ("в воображении"). Эти модели позволяют эффективное обучение сложных поведений без необходимости небезопасного или дорогостоящего реального взаимодействия со средой.

## История развития

### DreamerV1 (2019)
- Первый подход в семействе, представивший идею обучения в воображении
- Использовал вариационные автоэнкодеры для построения внутренней модели мира
- Продемонстрировал возможность обучения сложных поведений в симуляции

### DreamerV2 (2020)
- Улучшенная архитектура с дискретными представлениями
- Более стабильное обучение и лучшая сходимость
- Повышенная эффективность в различных средах

### DreamerV3 (2023)
- Масштабируемый агент, способный осваивать разнообразные домены
- Объединение подходов для дискретных и непрерывных действий
- Освоение разнообразных доменов через world модели

### Dreamer 4 (2025)
- Последняя версия с 2B параметров
- Использует новую целевую функцию "shortcut forcing"
- Первая модель, успешно решившая задачу получения алмазов в Minecraft исключительно на оффлайн-данных
- [[dreamer4.md|Dreamer 4]] - подробное описание новой архитектуры

## Общие принципы архитектуры

### Обучение в воображении
- Агент учится стратегии внутри модели мира, а не в реальной среде
- Позволяет эффективное и безопасное обучение
- Возможность масштабирования без увеличения реальных взаимодействий

### Модель мира
- Обучаемая модель динамики окружающей среды
- Предсказывает следующие состояния на основе текущих наблюдений и действий
- Служит внутренним симулятором для планирования

### Иерархические представления
- Внутренние представления разного уровня абстракции
- Позволяют эффективное планирование на разных временных горизонтах
- Компромисс между точностью и вычислительной эффективностью

## Ключевые инновации в Dreamer 4

### Shortcut Forcing
- Новая целевая функция, основанная на flow matching
- Предсказание чистого конечного состояния (x-prediction), а не вектора обновления (v-prediction)
- Стабильное предсказание на длинных горизонтах

### Эффективная трансформерная архитектура
- 2B параметров для высокоточной симуляции
- Факторизованное внимание и оптимизации для реального времени
- 21 FPS симуляции на одной GPU

## Применения и результаты

### Игровые среды
- Minecraft: задача получения алмазов
- Долгосрочное планирование и сложные иерархии задач
- [[../minecraft_ai.md|Minecraft AI]] - контекст применения

### Embodied AI
- Воплощённый интеллект в физических и виртуальных средах
- [[../embodied_ai.md|Embodied AI]] - общая область

### Робототехника
- Обучение роботов в симуляции перед применением в реальности
- Безопасное и эффективное обучение сложных навыков

## Преимущества подхода

### Эффективность данных
- Обучение на фиксированных оффлайн-датасетах
- Возможность использования огромных архивов видео без разметки
- Минимизация необходимости в онлайн-взаимодействии

### Безопасность
- Обучение без рисков в реальной среде
- Проверка стратегий в симуляции
- Контролируемая среда для экспериментов

### Обобщение
- Перенос знаний между разными средами
- Обучение на размеченных и неразмеченных данных
- Адаптация к новым задачам и ситуациям

## Связи с другими темами

- [[dreamer4.md|Dreamer 4]] - подробности о последней версии
- [[computer_vision/world_models.md|World модели]] - основополагающая концепция
- [[embodied_ai.md|Embodied AI]] - область применения
- [[reinforcement_learning/deep_rl/index.md]] - методы обучения
- [[../flow_matching.md|Flow matching]] - теоретическая основа
- [[minecraft_ai.md|Minecraft AI]] - применение в игре