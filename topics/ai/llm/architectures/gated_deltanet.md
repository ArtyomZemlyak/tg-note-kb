# Gated DeltaNet - архитектура с градиентным обучением во время инференса

## Описание

Gated DeltaNet - это рекуррентная архитектура, основанная на механизме дельта-правила (Delta Rule), которая использует гейтирование для улучшения способности модели к адаптации во время инференса. В статье "Titans: Learning to Memorize at Test Time" архитектура Gated DeltaNet используется как один из бенчмарков для сравнения с новой архитектурой Titans. Gated DeltaNet превосходит базовый DeltaNet за счёт использования гейтов для управления потоком информации и обновления параметров, что делает её более мощной в задачах адаптации во время инференса.

## Основная информация

DeltaNet и его гейтированная версия (Gated DeltaNet) относятся к классу рекуррентных моделей, в которых параметры могут адаптироваться на основе входных данных. Они основаны на дельта-правиле, которое является одним из основных алгоритмов обучения в нейронных сетях. В отличие от традиционных архитектур, где параметры фиксированы после обучения, DeltaNet-архитектуры позволяют модели адаптировать своё состояние в зависимости от входных данных.

Gated DeltaNet улучшает базовый DeltaNet за счёт добавления гейтов, которые контролируют, насколько текущие входные данные должны влиять на изменение параметров модели. Это позволяет модели избирательно обновлять свои параметры только для важной информации, избегая переобучения на шумных или нерелевантных данных.

## Технические детали

### Delta Rule

Основа для DeltaNet лежит в классическом дельта-правиле:

```
w(t+1) = w(t) - η ∇w l(w(t); x(t))
```

где `w` - параметры модели, `η` - скорость обучения, а `l` - функция потерь.

### Gated Mechanism

Gated DeltaNet включает гейт, который контролирует обновление параметров:

```
g(t) = sigmoid(W_g * x(t) + b_g)
Δw(t) = -η ∇w l(w(t); x(t))
w(t+1) = w(t) + g(t) ⊙ Δw(t)
```

где `g(t)` - гейт, определяющий, насколько параметры должны быть обновлены, `⊙` - поэлементное умножение, а `W_g`, `b_g` - параметры гейта.

### Сравнение с Titans

В отличие от Gated DeltaNet, архитектура Titans использует более сложный механизм:
- Модуль долгосрочной памяти (LMM) на основе глубокого MLP
- Обновления с использованием момента (momentum)
- Адаптивное забывание с зависящим от данных гейтом
- Более выразительная архитектура за счёт нелинейного рекуррентного модуля

В статье "Titans: Learning to Memorize at Test Time" архитектура Titans (включая её варианты MAC, MAG, MAL) превосходит Gated DeltaNet на многочисленных бенчмарках, включая задачи с длинным контекстом, где Gated DeltaNet и другие рекуррентные модели показывают значительно более низкие результаты.

## Применение и результаты

### Задачи, в которых участвует Gated DeltaNet
- Языковое моделирование
- Рассуждения с длинным контекстом
- Задачи с непрерывным обучением
- Задачи, требующие адаптации во время инференса

### Сравнение с Titans
- В задаче Needle-in-a-Haystack (NIAH) Gated DeltaNet показывает значительно более низкие результаты по сравнению с Titans (MAC), который достигает 95.2% в сложной подзадаче S-NIAH-W
- На бенчмарке BABILong Gated DeltaNet уступает архитектуре Titans, которая превосходит даже крупные модели вроде GPT-4
- В задачах языкового моделирования и рассуждений на основе здравого смысла Gated DeltaNet уступает Titan различным версиям

## Сравнение с другими архитектурами

### Отличия от базового DeltaNet
- Использование гейтов для управления обновлениями параметров
- Более стабильные обновления параметров за счёт гейтирования
- Повышенная способность к фильтрации шума

### Отличия от TTT (Test-Time Training)
- TTT обучает всю модель во время инференса, в то время как DeltaNet использует дельта-правило для конкретных компонентов
- TTT может быть более вычислительно затратным
- DeltaNet может быть более стабильным в определённых условиях

### Отличия от Titan
- Titan использует более сложный модуль LMM на основе глубокого MLP
- В Titan используется механизм "удивления" с моментом
- Titan имеет более сложную архитектуру интеграции с механизмом внимания
- Titan превосходит Gated DeltaNet в задачах с длинным контекстом

## Практические аспекты

### Реализация
- Требует реализации гейтов для управления параметрами
- Необходимость тщательной настройки гиперпараметров скорости обучения
- Поддержка адаптации параметров во время инференса

### Преимущества
- Возможность адаптации к новым данным во время инференса
- Более стабильные обновления по сравнению с базовым DeltaNet
- Меньшая вычислительная сложность по сравнению с полным TTT

### Ограничения
- Ограниченная выразительность по сравнению с Titan
- Потенциальные проблемы со стабильностью обновлений
- Сложность в настройке гиперпараметров

## Значение для ИИ

Gated DeltaNet представляет собой важный шаг в понимании архитектур, которые могут адаптироваться во время инференса. Она служит промежуточным звеном между статичными архитектурами и более сложными системами, такими как Titan, которые также адаптируются во время инференса. Архитектура показывает, что гейтирование может улучшить базовые алгоритмы адаптации, но также демонстрирует ограничения подходов, основанных на простых правилах обновления.

## Связи с другими темами

- [[titan_architecture.md]] - Архитектура, превосходящая Gated DeltaNet
- [[test_time_training.md]] - Связанная архитектура с адаптацией во время инференса
- [[lmm_long_term_memory_module.md]] - Модуль памяти в Titan, использующий более сложные механизмы
- [[mac_mag_mal_architectures.md]] - Архитектуры интеграции памяти в Titan
- [[state_space_models.md]] - Класс архитектур, решающих схожие задачи обработки последовательностей
- [[mamba_architecture.md]] - Современная архитектура State Space Model

## Источники

1. [Titans: Learning to Memorize at Test Time](https://arxiv.org/abs/2501.00663) - Оригинальная статья, в которой Gated DeltaNet используется как бейзлайн для сравнения с новой архитектурой Titans
2. [ArXivIQ Review: Titans Learning to Memorize at Test Time](https://arxiviq.substack.com/p/titans-learning-to-memorize-at-test) - Обзор статьи с анализом сравнения различных архитектур, включая Gated DeltaNet
3. [Delta Rule and Applications in Neural Networks](https://en.wikipedia.org/wiki/Delta_rule) - Объяснение классического дельта-правила, на котором основаны DeltaNet архитектуры