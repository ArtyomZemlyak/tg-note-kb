# DeepSeek-V3.2-Speciale

## Общее описание

DeepSeek-V3.2-Speciale - новая флагманская модель от DeepSeek, достигшая уровня топ-систем при обучении и генерации, стоящих в десятки раз дешевле, чем у GPT-5 и Gemini 3 Pro. Модель превосходит Gemini 3.0 Pro в математике и коде, обладая архитектурой MoE из семейства V3.1 Terminus с контекстом 128k. Главная инновация - внедрение DeepSeek Sparse Attention (DSA), разработанного для дешевого длинного контекста. Модель сочетает высокую вычислительную эффективность с превосходной способностью к рассуждению и агентным задачам.

## Ключевые особенности

- **Превосходящая производительность**: Превосходит Gemini 3.0 Pro в математике и коде
- **Рассуждения + агентность**: Новая флагманская модель совмещает рассуждения и агентные способности 
- **Архитектура**: MoE из семейства V3.1 Terminus с контекстом 128k
- **Главная инновация**: DeepSeek Sparse Attention (DSA) для дешевого длинного контекста
- **Экономичность**: Значительно дешевле в обучении и генерации по сравнению с конкурентами (GPT-5, Gemini 3 Pro)
- **Высокие достижения**: Золотая медаль в Международной математической олимпиаде (IMO) и Международной олимпиаде по информатике (IOI) 2025 года

## Технология DeepSeek Sparse Attention (DSA)

DSA - эффективный механизм внимания, который существенно снижает вычислительную сложность при сохранении производительности модели, специально оптимизированный для сценариев с длинным контекстом. Обычное внимание имеет сложность O(T²), что становится проблематичным при 128k токенов. DSA снижает стоимость до O(T·U), где U - небольшое число релевантных токенов, что делает длинный контекст реально дешевым.

### Как работает DSA

1. **Lightning Indexer** - лёгкая сеть оценивает важность каждого прошлого токена
2. **Fine-grained top-k** - модель выбирает только самые полезные токены и вычисляет внимание по ним

### Преимущества DSA по сравнению с традиционным вниманием

- Снижение вычислительной сложности с O(T²) до O(T·U)
- Сохранение качества при значительной экономии ресурсов
- Возможность эффективной обработки длинных контекстов (128k)
- Более дешёвая генерация и обучение
- Специально оптимизировано для длинного контекста

## Методы обучения с подкреплением и подготовка агентов

DeepSeek-V3.2 использует значительные ресурсы на обучение с подкреплением (RL), инвестировав более 10% мощностей от затраченных на базовую модель, что сравнимо с ведущими лабораториями. Модель использует специализированные подмодели и синтетические данные для подготовки универсального агента в шести областях: математика, программирование, общие логические рассуждения, общие агентские задачи, агентское программирование и агентский поиск.

### Генеративная модель вознаграждения (GRM)

Для оценки ответов в задачах, где не применяются простые тесты, используется GRM (Generative Reward Model) и специфичные рубрики, описывающие критерии оценки. Это позволяет более точно оценивать качество ответов в сложных агентных задачах.

### Техники стабилизации RL

DeepSeek применяют Off-Policy Sequence Masking для стабилизации обучения - маскируют последовательности, которые отклоняются от исходной модели больше определенного порога, если они хуже средней в группе генераций по оценке. Также сохраняют маски токенов, полученные из top-p / top-k семплирования, чтобы выровнять режимы генерации и обучения.

## Агентская подготовка

DeepSeek собрали и синтезировали 85 тысяч агентных задач в 4 категориях: Поисковый агент, Кодинг-агент, Общий агент и Кодовый интерпретатор. Для подготовки использовалась мультиагентная система на базе DeepSeek-V3.2, генерирующая разнообразные и высококачественные обучающие данные с помощью верификации и рубрик.

## Дополнительные технические инновации

### Масштабируемый фреймворк обучения с подкреплением (RL)
- Реализует надежный RL протокол с масштабированным пост-тренировочным вычислением
- Повышает качество рассуждений и агентных способностей модели

### Масштабный синтез агентных задач
- Новый синтезный пайплайн, генерирующий обучающие данные в больших объемах
- Улучшает подчинение и обобщение в сложных интерактивных средах
- Интегрирует рассуждения в сценарии использования инструментов

## Процесс обучения

Обучение проходило в 2 этапа, начиная с чекпоинта V3.1 (128k):

### Stage 1 - Плотное внимание
- Замороженная основная модель
- Обучается только DSA компонент
- Позволяет системе адаптироваться к новой архитектуре внимания

### Stage 2 - Постепенный переход
- Поэтапное введение DSA по всей модели
- Позволяет сохранить качество при переходе на новую архитектуру
- Обеспечивает сопоставимую или лучшую производительность по сравнению с предшественниками

## Архитектура модели

- **Тип**: Transformer архитектура с разреженным вниманием (на основе Mixture-of-Experts)
- **Параметры**: 685 миллиардов параметров (685B)
- **Точность**: BF16, F8_E4M3, F32
- **Формат**: Safetensors
- **Контекст**: 128k токенов
- **Компоненты**: Сочетание рассуждений и агентных способностей
- **Внимание**: DeepSeek Sparse Attention (DSA) для оптимизации вычислений
- **Специализация**: Глубокие задачи рассуждения (не поддерживает вызов инструментов)

## Производительность и сравнение

- **Математика и код**: Превосходит Gemini 3.0 Pro
- **Качество**: Выше, чем у предыдущих версий и конкурентов
- **Эффективность**: Дешевле в обучении и генерации, чем GPT-5 и Gemini 3 Pro
- **Длинный контекст**: Реально дешёвая обработка 128k токенов благодаря DSA
- **Олимпийские достижения**: Золотая медаль в IMO и IOI 2025 года
- **Сравнение с GPT-5**: Превосходит по производительности при значительно меньшей стоимости

## Специальные функции

- **Новый чат-шаблон**: Значительные обновления, включая отдельный формат для вызова инструментов и возможность "мышления с инструментами"
- **Новая роль**: Введение роли "developer" (разработчик), специализированной исключительно для сценариев поискового агента
- **Фокус на рассуждениях**: Модель DeepSeek-V3.2-Speciale разработана исключительно для задач глубокого рассуждения (не поддерживает функциональность вызова инструментов)
- **Оптимизация для локального развертывания**: Рекомендованные параметры: температура = 1.0, top_p = 0.95

## Технический отчет

Исследование и детали реализации опубликованы в техническом отчете: https://huggingface.co/deepseek-ai/DeepSeek-V3.2/resolve/main/assets/paper.pdf

## Сравнение с предыдущими версиями

- В отличие от DeepSeek-V3.1, включает технологию DSA
- В отличие от DeepSeek-V3.2-Exp (экспериментальной), является полноценной флагманской моделью
- Обеспечивает лучшую производительность по сравнению с предыдущими версиями
- Главное нововведение - эффективная обработка длинного контекста через DSA
- Превосходит предыдущие версии в задачах рассуждения и агентных задачах

## Значение для отрасли

DeepSeek-V3.2-Speciale представляет собой полноценную топ-систему уровня IMO/IOI/ICPC, при этом обучение и генерация стоят в десятки раз дешевле, чем у GPT-5 и Gemini 3 Pro. Это может значительно изменить экономическую модель разработки и использования ИИ-моделей, делая высококачественные решения более доступными. Модель демонстрирует новый подход к балансу между производительностью и вычислительной эффективностью.

## Связи с другими темами

- [[deepseek_sparse_attention.md]] - технология разреженного внимания, используемая в этой модели
- [[deepseek_v3_2_exp.md]] - экспериментальная версия с аналогичной технологией
- [[ai/llm/architectures/deepseek_v3.md]] - основная архитектура DeepSeek V3
- [[mixture_of_experts_architecture.md]] - архитектура смеси экспертов, используемая в модели
- [[ai/llm/techniques/multi_head_latent_attention.md]] - альтернативная технология внимания от DeepSeek
- [[specialized_attention_mechanisms.md]] - архитектуры специализированного внимания
- [[deepseek_v3_2_reinforcement_learning_agent_training.md]] - детали RL и подготовки агентов в V3.2
- [[thinking_retention_mechanism.md]] - механизм сохранения мышления, используемый в агентных задачах
- [[off_policy_sequence_masking.md]] - метод стабилизации обучения с подкреплением
- [[generative_reward_model_grm.md]] - генеративная модель вознаграждения для оценки ответов
- [[agent_training_with_synthetic_data.md]] - методы подготовки агентных систем с использованием синтетических данных

## Источники

- Технический отчет: https://huggingface.co/deepseek-ai/DeepSeek-V3.2/resolve/main/assets/paper.pdf
- Описание архитектуры: https://huggingface.co/deepseek-ai/DeepSeek-V3.2-Speciale
- Информация о технологии DSA: https://arxiv.org/abs/2502.11089
- Краткое описание на Hugging Face: https://huggingface.co/deepseek-ai/DeepSeek-V3.2-Speciale
- Модель на ModelScope: https://modelscope.cn/models/deepseek-ai/DeepSeek-V3.2-Speciale