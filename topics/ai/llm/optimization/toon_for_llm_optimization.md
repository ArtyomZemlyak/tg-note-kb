# TOON формат для оптимизации LLM

## Общее описание

**TOON (Token-Oriented Object Notation)** - это формат сериализации данных, оптимизированный специально для контекста Large Language Models (LLM), где количество токенов напрямую влияет на затраты, емкость контекста и задержки. Формат достигает 30-60% сокращения количества токенов по сравнению с JSON для табличных данных.

## Проблема использования токенов в LLM

В контексте работы с LLM, особенно при использовании коммерческих моделей, количество токенов напрямую влияет на:
- Стоимость API-вызовов
- Вместимость контекста модели
- Время обработки запросов
- Общую эффективность использования

## Как TOON решает проблему

TOON решает проблему чрезмерного использования токенов следующими способами:
1. **Компактный синтаксис**: убирает избыточную пунктуацию (повторяющиеся фигурные скобки и ключи)
2. **Табличный формат**: объявляет ключи один раз, а затем передает значения в виде строк данных
3. **Эффективная нумерация**: явно указывает длины массивов для лучшей валидации
4. **Минимизация кавычек**: строковые значения квотируются только при необходимости

## Бенчмарки эффективности

| Формат | Экономия токенов | Пример |
|--------|------------------|---------|
| JSON | - | 100% (базовый уровень) |
| JSON compact | ~28% | уменьшено на 28% по сравнению с форматированным JSON |
| YAML | ~39% | уменьшено на 39% по сравнению с форматированным JSON |
| XML | ~56% | уменьшено на 56% по сравнению с форматированным JSON |
| **TOON** | **49%** | **уменьшено на 49% по сравнению с форматированным JSON** |

## Применение в LLM

TOON особенно эффективен в следующих сценариях:
- Передача больших наборов табличных данных в промпты LLM
- Структурированные данные с однородными массивами объектов
- Сценарии, где точность извлечения данных важнее, чем читаемость человеком
- Запросы с высокой частотой, где небольшое сокращение токенов имеет значение

## Пример использования

### Пример с JSON (много токенов):
```json
{
  "repositories": [
    {
      "id": 28457823,
      "name": "freeCodeCamp",
      "repo": "freeCodeCamp/freeCodeCamp",
      "description": "freeCodeCamp.org's open-source codebase...",
      "stars": 430886
    },
    {
      "id": 132750724,
      "name": "build-your-own-x",
      "repo": "codecrafters-io/build-your-own-x",
      "description": "Master programming by recreating...",
      "stars": 430877
    }
  ]
}
```

### Пример с TOON (меньше токенов):
```
repositories[2]{id,name,repo,description,stars}:
  28457823,freeCodeCamp,freeCodeCamp/freeCodeCamp,"freeCodeCamp.org's open-source codebase...",430886
  132750724,build-your-own-x,codecrafters-io/build-your-own-x,Master programming by recreating...,430877
```

## Интеграция с системами LLM

TOON можно использовать в следующих сценариях:
- В качестве промежуточного формата между JSON и LLM
- Для передачи структурированных данных в промпты с сохранением точности извлечения
- При реализации систем кеширования данных для LLM
- В инструментах, которые генерируют структурированные ответы

## Связанные темы

[[programming/data_formats/toon_format.md]] - Технические детали формата TOON
[[ai/llm/prompt_engineering/prompt_optimization_techniques.md]] - Техники оптимизации промптов
[[ai/llm/optimization/llm_token_efficiency.md]] - Общие подходы к эффективности использования токенов
[[ai/llm/tools/lmms_engine.md]] - Инструменты для работы с мультимодальными моделями, которые могут использовать TOON
[[ai/llm/prompt_engineering/cot_synthesis_approaches.md]] - Подходы к синтезу цепочки рассуждений, которые могут использовать структурированные данные TOON