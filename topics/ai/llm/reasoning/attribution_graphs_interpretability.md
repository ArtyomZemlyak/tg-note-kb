# Атрибуционные графы в интерпретируемости трансформеров

## Краткое описание

Атрибуционные графы - это структуры данных, используемые для представления и анализа причинно-следственных связей внутри трансформеров. Они показывают, как различные компоненты модели (внимание, MLP-слои, токены) взаимодействуют друг с другом и влияют на окончательный вывод. Эти графы являются основой для методов механистической интерпретируемости, таких как Circuit-based Reasoning Verification (CRV).

## Основная информация

### Основные концепции

1. **Атрибуционный граф (Attribution graph)**: Взвешенный ориентированный граф, где узлы представляют компоненты модели (интерпретируемые признаки, токены, логиты), а ребра представляют причинно-следственные связи между ними с количественными оценками силы влияния.

2. **Пути с высокой атрибуцией (High-attribution pathways)**: Конкретные пути в графе, по которым проходит наибольшее влияние, например, от раннего признака к более позднему или от признака к логиту.

3. **Каузальный анализ (Causal analysis)**: Методы, направленные на выявление причинно-следственных связей в вычислениях модели, а не просто корреляций.

4. **Методология анализа схем (Circuit analysis methodology)**: Систематический подход к построению и анализу атрибуционных графов для понимания внутренних вычислений модели.

5. **Интерпретируемые признаки (Interpretable features)**: Признаки, которые были обучены или идентифицированы как представляющие понятные человеку понятия или вычисления.

### Архитектура и методология

Создание и анализ атрибуционных графов включает:

1. **Создание интерпретируемой модели**: Замена стандартных компонентов на интерпретируемые альтернативы (например, транскодеры вместо MLP-модулей) для получения интерпретируемых признаков.

2. **Методы трассировки обратно от логитов**: Использование алгоритмов для отслеживания высокой атрибуции обратно от финальных логитов к внутренним компонентам.

3. **Построение графа**: Формирование взвешенного направленного графа G = (V, E), где V - множество узлов (токены, активные признаки, логиты), а E - множество ребер, представляющих причинно-следственные связи с количественной оценкой силы влияния.

4. **Принципиальный метод трассировки информации**: Адаптация методологии анализа схем для трассировки причинно-следственных связей в вычислениях.

5. **Извлечение признаков**: Превращение графа в фиксированный вектор признаков, который может быть использован для классификации или анализа.

### Отличия от существующих подходов

В отличие от:

- **Простого анализа активаций**: Который не учитывает причинно-следственные связи между компонентами
- **Анализа внимания**: Который показывает, на что модель "смотрит", но не объясняет, как информация обрабатывается
- **Статических представлений**: Которые не показывают динамику и причинные пути

Атрибуционные графы:
- Предоставляют динамическое представление вычислительного процесса
- Показывают причинно-следственные связи, а не просто корреляции
- Позволяют анализировать информационные потоки между компонентами

## Новые концепции и термины

- **Интервенции (Interventions)**: Манипуляции с внутренними состояниями модели для проверки причинно-следственных гипотез.
- **Причинные паттерны (Causal patterns)**: Характерные структуры в атрибуционных графах, соответствующие определенным вычислениям или ошибкам.
- **Анализ топологии графа**: Изучение структуры графа, включая плотность, центральность, метрики связности.
- **Прядильщики признаков (Feature encoders)**: Компоненты, которые кодируют информацию в интерпретируемых признаках.
- **Причинное объяснение (Causal explanation)**: Объяснение поведения модели на основе выявленных причинно-следственных связей.

## Примеры применения

- **Анализ ошибок рассуждений**: Идентификация причинно-следственных паттернов, связанных с ошибочными рассуждениями
- **Верификация рассуждений**: Использование структуры графа для определения корректности шагов рассуждений
- **Целевые вмешательства**: Использование информации из графа для коррекции нежелательного поведения
- **Анализ доменно-специфических вычислений**: Изучение различий в причинно-следственных паттернах между различными задачами

## Связи с другими темами

[[ai/llm/reasoning/circuit_based_reasoning_verification.md]] - Применение атрибуционных графов для верификации рассуждений
[[ai/llm/mechanistic_interpretability.md]] - Общий контекст анализа внутренних механизмов моделей
[[ai/llm/reasoning/computational_graphs_in_llm_reasoning.md]] - Общее описание вычислительных графов в рассуждениях
[[ai/llm/mechanistic_interpretability/transcoders_for_interpretability.md]] - Интерпретируемые компоненты, используемые для создания атрибуционных графов
[[ai/llm/activation_engineering.md]] - Анализ внутренних активаций и их интерпретация

## Ссылки на источники

- Оригинальная работа по Circuit-based Reasoning Verification (CRV)
- Исследования по механистической интерпретируемости трансформеров
- Работы по анализу схем Dunefsky et al. (2025)
- Исследования по транскодерам и разреженной интерпретируемости