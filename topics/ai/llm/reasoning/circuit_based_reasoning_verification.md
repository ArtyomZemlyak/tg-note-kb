# Circuit-based Reasoning Verification (CRV) - верификация рассуждений на основе схем

## Краткое описание

Circuit-based Reasoning Verification (CRV) - это метод белого ящика для верификации Chain-of-Thought (CoT) рассуждений в больших языковых моделях (LLM). В отличие от существующих методов черного и стеклянного ящика, CRV анализирует структурные "отпечатки" вычислительного графа рассуждений, чтобы определить, является ли шаг рассуждения корректным или нет. Метод позволяет не просто обнаруживать ошибки, но и понимать, почему вычисление не удалось, что дает более глубокое понимание причинно-следственных механизмов ошибок в рассуждениях LLM.

## Основная информация

### Основные концепции

1. **Chain-of-Thought (CoT) рассуждения**: Метод, при котором LLM генерирует промежуточные шаги при решении задач, что значительно улучшает производительность на сложных задачах.

2. **Circuit-based Reasoning Verification (CRV)**: Белый ящик подход для верификации рассуждений, который анализирует структурные признаки вычислительного графа, полученного из внутреннего состояния модели.

3. **Атрибуционные графы (Attribution graphs)**: Графы, представляющие причинно-следственные связи между компонентами модели (например, между интерпретируемыми признаками и логитами).

4. **Транскодеры (Transcoders)**: Модифицированные разреженные автоэнкодеры, обученные аппроксимировать функцию вход-выход целевого компонента (например, MLP), что позволяет сделать внутренние вычисления модели более интерпретируемыми.

5. **Структурные "отпечатки ошибок" (Structural fingerprints of errors)**: Определенные паттерны в атрибуционных графах, которые характеризуют неправильные шаги рассуждений и отличаются от паттернов корректных шагов.

### Архитектура и методология

CRV состоит из четырех этапов:

1. **Замена MLP на интерпретируемые транскодеры**: Каждый MLP-модуль в трансформере заменяется обученным транскодером, который обеспечивает разреженное, интерпретируемое представление внутренних состояний.

2. **Построение атрибуционных графов на уровне шагов**: Для каждого шага CoT создается взвешенный ориентированный граф, представляющий причинно-следственные связи между интерпретируемыми признаками и компонентами модели.

3. **Извлечение интерпретируемых признаков графа**: Из каждого атрибуционного графа извлекается вектор признаков, представляющий структурный "отпечаток" вычисления. Признаки делятся на три иерархических уровня:
   - Глобальная статистика графа
   - Статистика влияния и активации узлов
   - Топологические и пути-ориентированные признаки

4. **Диагностический классификатор**: Обучается градиентный бустинг классификатор, который принимает вектор структурных признаков и предсказывает корректность шага рассуждения.

### Отличия от существующих подходов

В отличие от:

- **Методов черного ящика**: Анализируют только выходной текст или конечное распределение логитов
- **Методов стеклянного ящика**: Рассматривают внутренние состояния модели, используя простые зонды или анализируя траектории скрытых состояний, но не объясняют, почему лежащее в основе вычисление приводит к ошибке

CRV позволяет:
- Анализировать причинно-следственную структуру вычисления рассуждения
- Обнаруживать структурные сигнатуры ошибок в вычислительных схемах модели
- Выполнять целевые интервенции для исправления ошибочных рассуждений

## Новые концепции и термины

- **Структурная сигнатура ошибки (Structural signature of error)**: Уникальный паттерн в атрибуционном графе, указывающий на неправильное рассуждение.
- **Вычислительные схемы (Computational circuits)**: Специфические подграфы в нейронной сети, реализующие понятные человеку алгоритмы.
- **Причинные пути с высокой атрибуцией (High-attribution causal pathways)**: Пути в графе, по которым проходит основное влияние между компонентами модели.
- **Целевые интервенции (Targeted interventions)**: Направленные изменения в отдельных признаках транскодера для коррекции ошибочных рассуждений.

## Примеры применения

- **Верификация цепочек рассуждений**: Определение корректности промежуточных шагов в CoT-рассуждениях
- **Диагностика ошибок рассуждений**: Понимание, почему и где именно в процессе рассуждения возникает ошибка
- **Исправление ошибочных рассуждений**: Вмешательство в конкретные признаки для исправления неправильного рассуждения
- **Анализ доменно-специфических ошибок**: Изучение различий в паттернах ошибок для разных типов задач (логика, арифметика, языковая арифметика)

## Связи с другими темами

[[ai/llm/reasoning/attribution_graphs_interpretability.md]] - Подробное описание атрибуционных графов и их использования в интерпретируемости
[[ai/llm/mechanistic_interpretability.md]] - Общие принципы механистической интерпретируемости, в которой работает CRV
[[ai/llm/prompt_engineering/cot_variants.md]] - Методы Chain-of-Thought рассуждений, которые анализирует CRV
[[ai/llm/reasoning/sft_rlvr_methodology.md]] - Альтернативные методы верификации рассуждений
[[ai/llm/mechanistic_interpretability/transcoders_for_interpretability.md]] - Подробное описание транскодеров, используемых в методе CRV

## Ссылки на источники

- Оригинальная научная работа: "Verifying Chain-of-Thought Reasoning via Its Computational Graph", arXiv:2510.09312v1
- Авторы: Zheng Zhao, Yeskendir Koishekenov, Xianjun Yang, Naila Murray, Nicola Cancedda (FAIR at Meta, University of Edinburgh)