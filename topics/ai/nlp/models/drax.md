# Drax: Распознавание речи с дискретным флоу-мэтчингом

## Общее описание

**Drax** — это новая архитектура для автоматического распознавания речи (ASR), использующая подход дискретного флоу-мэтчинга (discrete flow matching) для эффективного параллельного декодирования. Разработанная командой aiOla Research, модель позволяет достичь точности, сопоставимой с современными моделями распознавания речи, при улучшенных соотношениях точности и эффективности ([Drax: Speech Recognition with Discrete Flow Matching](https://arxiv.org/abs/2510.04162)).

## Архитектура

Drax представляет собой энкодер-декодерную модель с использованием:

- **Энкодер:** Whisper-large-v3 энкодер для преобразования аудио-входа в скрытое представление
- **Декодер:** DiT (Diffusion Transformer) основанный декодер, реализующий подход дискретного флоу-мэтчинга ([Drax GitHub Repository](https://github.com/aiola-lab/drax))

## Ключевые инновации

### 1. Дискретный флоу-мэтчинг в ASR

Drax — одна из первых моделей, адаптирующих методы дискретного флоу-мэтчинга для задач распознавания речи. В отличие от традиционных автогрессивных моделей, которые генерируют токены последовательно, Drax использует нон-автогрессивный (non-autoregressive) подход, позволяющий генерировать весь текстовый выход параллельно ([Drax: Speech Recognition with Discrete Flow Matching](https://arxiv.org/abs/2510.04162)).

### 2. Аудио-условные вероятностные пути

Для лучшего согласования обучения с инференсом, Drax строит аудио-условный вероятностный путь, который направляет модель через траектории, напоминающие вероятные промежуточные ошибки инференса, вместо прямых переходов от случайного шума к цели ([Drax: Speech Recognition with Discrete Flow Matching](https://arxiv.org/abs/2510.04162)).

### 3. Теоретическое обоснование

Анализ показывает, что зазор обобщающей способности связан с расхождениями между обучением и инференсом занятости, контролируемой накопленными ошибками скорости. Это теоретическое понимание мотивирует выбор архитектуры ([Drax: Speech Recognition with Discrete Flow Matching](https://arxiv.org/abs/2510.04162)).

## Технические детали

### Реализация
- **Язык программирования:** Python
- **Фреймворки:** PyTorch
- **Общее количество параметров:** ~1.2B
- **Поддерживаемые языки:** 8 языков (английский, испанский, французский, португальский, немецкий, итальянский, японский, китайский)

### Использование
Для использования модели доступен Python пакет `drax`:

```python
from drax import Transcriber

asr = Transcriber(model_path="aiola/drax-v1")  # Hugging Face репозиторий или локальный путь
result = asr.transcribe("/путь/к/аудио.wav", language="en")
print(result[0].transcript)
```

## Преимущества

- **Параллельное декодирование:** Благодаря нон-автогрессивной архитектуре, Drax может декодировать текст параллельно, что значительно ускоряет инференс
- **Современная точность:** Модель достигает точности, сопоставимой с современными ASR моделями
- **Улучшенные компромиссы точности и эффективности:** По сравнению с другими подходами, Drax предлагает лучшее соотношение между точностью распознавания и вычислительной эффективностью ([Drax: Speech Recognition with Discrete Flow Matching](https://arxiv.org/abs/2510.04162))

## Сравнение с другими моделями

| Модель | Архитектура | Подход к декодированию | Точность | Эффективность |
|--------|-------------|------------------------|----------|----------------|
| Whisper | Трансформер | Автогрессивный | Высокая | Ниже (последовательное декодирование) |
| Drax | Энкодер-декодер (Whisper + DiT) | Нон-автогрессивный (флоу-мэтчинг) | Сопоставима с SOTA | Выше (параллельное декодирование) |

## Применение

Drax может быть использован в следующих сценариях:
- Транскрибация аудио и видео в реальном времени
- Приложения, требующие низкой задержки распознавания речи
- Системы, где важна эффективность вычислений

## Связи с другими темами

- [[speech_recognition.md]] - Общие принципы распознавания речи
- [[discrete_flow_matching_asr.md]] - Подробное описание дискретного флоу-мэтчинга в ASR
- [[flow_matching.md]] - Общая концепция флоу-мэтчинга
- [[diffusion_models.md]] - Диффузионные модели, близкие подходы
- [[whisper.md]] - Сравниваемая архитектура с Whisper энкодером

## Источники

1. [Drax: Speech Recognition with Discrete Flow Matching](https://arxiv.org/abs/2510.04162) - Оригинальная статья о Drax, описывающая архитектуру и подход дискретного флоу-мэтчинга в ASR
2. [Drax Hugging Face Model](https://huggingface.co/aiola/drax-v1) - Модель Drax-v1 на Hugging Face, содержащая веса и документацию
3. [Drax GitHub Repository](https://github.com/aiola-lab/drax) - Официальный репозиторий с исходным кодом и инструкциями по использованию