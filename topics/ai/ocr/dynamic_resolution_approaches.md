# Dynamic Resolution Approaches (NaViT и др.)

## Описание

Dynamic Resolution Approaches - это семейство методов, позволяющих визуально-языковым моделям обрабатывать изображения с различным разрешением без необходимости в предварительном изменении размера (resize) или нарушении пропорций. Ключевым представителем является NaViT (Native-resolution Vision Transformer), который позволяет обрабатывать изображения в их родном разрешении с эффективным объединением последовательностей.

## NaViT (Native-resolution Vision Transformer)

### Основная идея
NaViT позволяет визуальным моделям обрабатывать изображения любого разрешения без искажений, сохраняя оригинальные пропорции и детали. Вместо фиксированного патчинга изображения, NaViT использует подход "native-resolution sequence packing".

### Архитектура

#### Native-resolution Sequence Packing
- Изображения разного размера разбиваются на патчи независимо
- Патчи объединяются в последовательности переменной длины
- Используются маски для обработки последовательностей разной длины в batch

#### Встроенные механизмы адаптации
- Маскирование для обработки переменных длин последовательностей
- Адаптивные слои нормализации для стабилизации обучения
- Возможность обработки нескольких изображений в одном batch с разным разрешением

### Преимущества

#### Отсутствие искажений
- Сохранение оригинальных пропорций изображений
- Отсутствие артефактов от resize операций
- Более точное сохранение пространственной информации

#### Эффективность
- Возможность обработки изображений разных размеров в одном batch
- Эффективное использование вычислительных ресурсов
- Позволяет обрабатывать высокоразрешающие изображения напрямую

#### Гибкость
- Поддержка произвольных разрешений
- Подходит для документов с разными форматами (A4, A3, письмо и т.д.)
- Унификация обработки разных типов визуального контента

## Применение в PaddleOCR-VL

### В PaddleOCR-VL-0.9B
- PaddleOCR-VL-0.9B интегрирует NaViT-стиль динамического высокого разрешения
- Визуальный энкодер использует структуру NaViT, инициализированную из keye-vl
- Поддерживает нативное разрешение входных изображений без искажений
- Снижает количество галлюцинаций за счет сохранения оригинальной информации

### Преимущества для OCR
- Точное распознавание текста на изображениях разного размера
- Сохранение мелких деталей текста на высокоразрешающих изображениях
- Отсутствие потерь информации из-за resize операций

## Другие подходы к динамическому разрешению

### FoveaBox
- Адаптивное определение размера ячеек для разных масштабов
- Позволяет эффективно обрабатывать объекты разных размеров

### Feature Pyramid Networks (FPN)
- Многоуровневая обработка признаков для разных разрешений
- Позволяет модели улавливать детали на разных масштабах

### Swin Transformer
- Иерархическая структура с смещенным оконным вниманием
- Позволяет обрабатывать изображения переменного размера

## Сравнение с традиционными подходами

| Характеристика | Традиционный подход | Dynamic Resolution (NaViT) |
|----------------|---------------------|----------------------------|
| Обработка разрешений | Фиксированные разрешения | Произвольные разрешения |
| Искажения изображения | Возможны из-за resize операций | Минимальные или отсутствуют |
| Эффективность | Высокая при стандартных разрешениях | Высокая при разнообразных разрешениях |
| Поддержка высокого разрешения | Ограничена требованиями к памяти | Позволяет обрабатывать без resize |
| Гибкость | Ограничена фиксированным размером | Высокая гибкость |

## Преимущества для документного OCR

### Обработка документов разных форматов
- PDF-файлы разных размеров (A4, A3, письменный формат и т.д.)
- Сканированные документы с разным DPI
- Веб-страницы и скриншоты произвольного размера

### Сохранение качества текста
- Мелкий текст не теряется при resize операциях
- Сохранение четкости границ текста
- Уменьшение количества ошибок распознавания

### Снижение галлюцинаций
- Прямая обработка оригинального изображения
- Сохранение всех пространственных отношений
- Уменьшение вероятности ошибок интерпретации

## Связи с другими темами

- [[paddleocr_vl.md]] - PaddleOCR-VL использует NaViT-стиль динамического разрешения в PaddleOCR-VL-0.9B
- [[pp_doclayoutv2.md]] - Второй этап системы использует динамическое разрешение для обработки элементов
- [[ai/computer_vision/vision_transformers.md]] - Основа архитектуры NaViT на Vision Transformers
- [[ai/computer_vision/object_detection/rtdetr.md]] - Другие подходы к обработке изображений разного размера
- [[ai/ocr/document_analysis.md]] - Общие подходы к анализу документов, включая обработку разного разрешения

## Источники

1. [NaViT: Native-resolution Vision Transformer](https://arxiv.org/abs/2307.02007) - Оригинальная статья о NaViT и подходе native-resolution sequence packing
2. [PaddleOCR-VL: Boosting Multilingual Document Parsing with a Two-Stage Framework](https://arxiv.org/html/2510.14528v2) - Использование NaViT-стиля динамического разрешения в PaddleOCR-VL-0.9B
3. [Zhihu Article: Two-Stage Multimodal Document Parsing Model](https://zhuanlan.zhihu.com/p/1962581920517986232) - Описание визуального энкодера с NaViT структурой, инициализированным из keye-vl
4. [MarkTechPost: Baidu's PaddlePaddle Team Releases PaddleOCR-VL-0.9B](https://www.marktechpost.com/2025/10/17/baidus-paddlepaddle-team-releases-paddleocr-vl-0-9b-a-navit-style-ernie-4-5-0-3b-vlm-targeting-end-to-end-multilingual-document-parsing/) - Описание интеграции NaViT-стиля динамического высокого разрешения с ERNIE-4.5-0.3B