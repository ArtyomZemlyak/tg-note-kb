# Обнаружение объектов и OCR

## Обнаружение объектов (Object Detection)

### YOLO (You Only Look Once)

YOLO - это семейство алгоритмов глубокого обучения для задачи обнаружения объектов в реальном времени. Он обрабатывает изображение за один проход, что делает его особенно быстрым для применения в реальном времени.

#### Архитектура YOLO
- Обрабатывает изображение целиком за один проход (unified detection)
- Разбивает изображение на сетку ячеек (grid cells)
- Для каждой ячейки предсказывает границы объектов (bounding boxes) и вероятности классов
- Основные компоненты: backbone, neck, head

#### Преимущества YOLO
- Высокая скорость обработки
- Превосходная точность для задач реального времени
- Одновременное обнаружение множества объектов

### RT-DETR (Real-Time Detection Transformer)

RT-DETR - это гибридный фреймворк для эффективного объектного детектирования, разработанный Baidu. Он решает проблему многошагового энкодера-декодера в традиционных DETR-моделях, используя IoU-aware query selection для улучшения запросов объектов и уменьшения избыточных вычислений.

#### Архитектура RT-DETR
- Efficient Hybrid Encoder
- IoU-aware Query Selection
- Anchor-free Structure
- Использует трансформеры для эффективного детектирования

#### Преимущества RT-DETR
- Скорость работы в реальном времени
- Высокая точность при эффективной обработке
- Подходит для ресурсоемких приложений
- Уменьшенные вычислительные затраты по сравнению с DETR

#### Применение RT-DETR
- Анализ макета документов (используется в PP-DocLayoutV2 как часть PaddleOCR-VL)
- Обнаружение элементов макета: текстовые блоки, таблицы, формулы, графики
- Коммерческие приложения (например, анализ сложных документов)

## Optical Character Recognition (OCR)

OCR - это технология преобразования изображений текста (печатного, рукописного) в машинно-читаемый текст.

### Как работает OCR
1. **Предварительная обработка** - улучшение качества изображения
2. **Сегментация** - выделение отдельных символов, строк, абзацев
3. **Распознавание** - использование шаблонов или нейронных сетей для распознавания символов
4. **Постобработка** - улучшение точности с использованием лексиконов и грамматических правил

### Алгоритмы OCR
- **Сопоставление матриц (Matrix matching)** - пиксельное сопоставление с шаблонами
- **Извлечение признаков (Feature extraction)** - анализ линий, контуров, пересечений
- **Нейронные сети** - современные системы используют глубокое обучение

### Применение OCR
- Сканирование документов
- Распознавание номерных знаков
- Обработка паспортов и документов
- Распознавание текста на изображениях (как в поиске по фото)

## Интеграция в поисковые системы по фото

YOLO и OCR часто работают вместе в системах поиска по фото:
1. YOLO выделяет объекты из изображения
2. OCR извлекает текстовые данные (артикулы, названия, надписи)
3. Эти данные используются для уточнения поиска и повышения точности

### Пример из Wildberries
- YOLO определяет и вырезает объекты с фото
- OCR снимает артикулы и текст с изображения
- Полученные данные комбинируются с визуальными признаками для поиска похожих товаров

## Применение RT-DETR в анализе документов

В контексте PaddleOCR-VL, RT-DETR используется в PP-DocLayoutV2 для:
- Обнаружения текстовых блоков, таблиц, формул и графиков
- Определения структуры документа
- Подготовки элементов для второго этапа распознавания в PaddleOCR-VL-0.9B

## Сравнение YOLO и RT-DETR для OCR задач

| Характеристика | YOLO | RT-DETR |
|----------------|------|---------|
| Скорость | Высокая | Очень высокая (в реальном времени) |
| Точность | Хорошая | Высокая |
| Архитектура | CNN-based | Transformer-based |
| Подход | Unified detection | Attention-based detection |
| Применение в OCR | Общее детектирование | Специфичное для документов |

## Связи с другими темами

- [[ai/computer_vision/visual_search/wildberries_photo_search.md]] - Применение YOLO и OCR в поиске по фото
- [[ai/computer_vision/multimodal_models.md]] - Комбинация визуальных и текстовых данных
- [[ai/nlp/russian_slang_isho.md]] - Обработка текстовых данных из OCR
- [[chandra_ocr.md]] - Современная OCR-модель от DataLab с поддержкой 40+ языков и высокой точностью распознавания
- [[deepseek_ocr.md]] - Современное решение OCR от DeepSeek с высокой эффективностью обработки документов
- [[lightonocr.md]] - Современная OCR-модель от LightOnAI, дистиллированная из Qwen2-VL-72B-Instruct, обеспечивающая высокое качество и скорость при низкой стоимости
- [[paddleocr_vl.md]] - Двухэтапная мультиязычная модель анализа документов от Baidu, использующая RT-DETR в PP-DocLayoutV2
- [[pp_doclayoutv2.md]] - Система анализа макетов документа, использующая RT-DETR и Pointer Networks
- [[ai/ocr/pointer_networks.md]] - Pointer Networks для определения порядка чтения элементов в документах
- [[ai/ocr/dynamic_resolution_approaches.md]] - Подходы к обработке изображений переменного разрешения, включая NaViT
- [[ai/computer_vision/object_detection/rtdetr.md]] - Подробная информация о RT-DETR как компоненте PP-DocLayoutV2
- [[docling.md]] - Библиотека обработки документов от IBM, сочетающая возможности OCR и структурного анализа документов
- [[ai/llm/models/multimodal/ibm_granite_docling_258m.md]] - Мультимодельная модель IBM для преобразования документов, интегрированная с библиотекой DocLing