# Muon - Оптимизатор с ортогонализацией Ньютона-Шульца

## Описание

Muon - это современный оптимизатор второго порядка, который использует итерацию Ньютона-Шульца для ортогонализации матрицы градиентов. Он представляет собой альтернативу традиционным оптимизаторам первого порядка, таким как Adam, и был разработан для улучшения сходимости в задачах обучения нейронных сетей.

## Механизм работы

Muon использует итерацию Ньютона-Шульца для достижения ортогонализации матрицы градиента:

- Он стремится к установке всех сингулярных значений обновления в ±1
- Использует процесс спектральной нормализации для ортогонализации
- Достигает соотношения сингулярных значений, очень близкого к 1, что указывает на высокую точность спектральной нормализации

## Особенности

1. **Высокая точность спектральной нормализации**: Muon достигает близкого к идеалу соотношения максимального сингулярного значения к среднему, благодаря итерации Ньютона-Шульца

2. **Интеграция с Triton ядрами**: Muon оптимизирован с использованием Triton ядер для эффективного выполнения на GPU

3. **Применение в продвинутых моделях**: Muon был использован в производственной модели Kimi K2, что стало первым случаем его применения для модели такого размера (до 1 триллиона параметров)

## Применение

Muon был успешно использован в архитектуре Kimi K2, где он заменил стандартный AdamW. Это привело к:
- Лучшей стабильности обучения
- Более гладким кривым обучения
- Отличным кривым потерь при обучении

## Сравнение с другими оптимизаторами

В ходе анализа "What Really Matters in Matrix-Whitening Optimizers?" было обнаружено, что несмотря на более точную спектральную нормализацию, Muon уступает SOAP в финальной производительности. Это открытие бросает вызов традиционной теории, акцентирующей внимание на идеальной спектральной нормализации.

## Адаптация дисперсии

Изначально Muon реализует простой подписанный спуск, но может быть расширен до версии AdaMuon с адаптацией дисперсии, что значительно улучшает его производительность.

## Интеграции и упоминания

- [[kimi_k2.md]] - Использование Muon в архитектуре Kimi K2
- [[matrix_whitening_optimizers.md]] - Контекст семейства матричных отбеливающих оптимизаторов
- [[soap_optimizer.md]] - Сравнение с SOAP, который превосходит Muon
- [[deep_optimizers.md]] - Альтернативная концепция оптимизаторов, использующая обучаемые многоуровневые структуры

## Ссылки на источники

- Jordan, K. (2023). Muon: Newton-Schulz Whitening. https://kellerjordan.github.io/posts/muon
- Frans, K., Abbeel, P., & Levine, S. (2024). What Really Matters in Matrix-Whitening Optimizers? https://arxiv.org/abs/2510.25000
- Zhang, S., et al. (2025). AdaMuon: Adding Variance Adaptation to Muon. https://arxiv.org/abs/2507.11005