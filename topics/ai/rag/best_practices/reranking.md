# Реранжирование результатов поиска в RAG-системах

## Описание

Реранжирование (reranking) - это процесс дополнительного ранжирования результатов поиска после первоначального извлечения с помощью KNN (k-nearest neighbors) или других методов. Реранжирование позволяет улучшить релевантность извлеченных документов перед передачей в LLM для генерации ответа.

## Зачем нужно реранжирование

- KNN-поиск в векторной базе данных дает приближенные результаты
- Реранжирование учитывает семантическую совместимость на уровне точного сопоставления
- Позволяет улучшить качество ответов RAG-системы
- Особенно важно для задач, где точность извлечения критична

## Популярные модели реранжирования

### BAAI/bge-reranker-v2-m3

- Модель реранжирования от BAAI
- Мультиязычная поддержка
- Высокая точность для различной лингвистической пары

### Qwen3-Reranker-8B

- Модель реранжирования от Alibaba
- Часть фреймворка Qwen3
- Интеграция с Qwen-моделями для генерации

## Методы реранжирования

### Cross-encoder reranking

- Обрабатывает пары (запрос, документ) целиком
- Более точный, но вычислительно затратный
- Лучше подходит для финального ранжирования ограниченного числа документов

### Bi-encoder reranking

- Кодирует запрос и документы отдельно
- Быстрее, но может уступать по точности
- Подходит для предварительного отбора

## Практические рекомендации

### Пайплайн реранжирования

1. Извлечение документов с помощью KNN в векторной базе
2. Реранжирование с использованием одной из моделей
3. Отбор топ-K наиболее релевантных документов для генерации

### Выбор модели

- BAAI/bge-reranker-v2-m3 для мультиязычных систем
- Qwen3-Reranker-8B для интеграции с Qwen-фреймворком
- Оценка на задачах, близких к вашему домену

### Оптимизация производительности

- Реранжирование только топ-N документов из векторной базы
- Баланс между точностью и скоростью
- Возможность использования кэширования для частых запросов

## Связи с другими темами

- [[./overview.md]] - Общие рекомендации по RAG практикам
- [[./embedding_models.md]] - Модели для генерации эмбеддингов
- [[./vector_databases.md]] - Векторные базы данных для первоначального поиска

## Источники

1. [BGE Reranker v2 M3](https://huggingface.co/BAAI/bge-reranker-v2-m3) - мультиязычная модель реранжирования от BAAI
2. [Qwen3 Reranker 8B](https://huggingface.co/Qwen3-Reranker-8B) - модель реранжирования от Alibaba, часть фреймворка Qwen3
3. [Best RAG Practices (2024)](https://arxiv.org/abs/2407.01219) - исследование с анализом различных подходов к реранжированию и их влиянием на качество RAG-систем