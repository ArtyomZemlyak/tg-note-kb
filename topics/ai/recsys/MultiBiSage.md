# MultiBiSage: Многоуровневая би-графовая модель Sage

## Описание

MultiBiSage - это расширение архитектуры PinSage, разработанное для обработки нескольких двудольных графов в рекомендательной системе. Модель была создана как развитие подхода PinSage для учета различных типов взаимодействий и доменов в экосистеме Pinterest.

## Контекст

MultiBiSage появилась как продолжение развития рекомендательных систем в Pinterest:
- Является наследником PinSage
- Решает проблему интеграции информации из разных графов взаимодействий
- Позволяет лучше учитывать разнообразие типов взаимодействий (поиск, реклама, товары и т.д.)

## Архитектура

### Множество графов

MultiBiSage работает с 6 двудольными графами:
- pin-board граф (основной)
- реклама
- поиск
- товары
- И другие домены

### Предварительный отбор соседей

- Для каждого графа заранее (офлайн) отбираются по 50 соседей через Pixie
- Pixie используется для сэмплирования релевантных соседей
- Это позволяет уменьшить вычислительную сложность

### Трансформерная агрегация

- Для каждого соседства применяется трансформер (над целевой вершиной и соседями)
- Затем глобальный трансформер агрегирует векторы из разных графов
- Это позволяет эффективно комбинировать информацию из разных доменов

### Обучение

- Используются положительные пары: item2item (seed item → clicked item)
- Трансформеры позволяют более гибко моделировать взаимодействия

## Преимущества по сравнению с PinSage

- **Интеграция информации из разных доменов**: позволяет учитывать связи из разных графов
- **Более сложная агрегация**: трансформеры вместо простого усреднения
- **Гибкость**: может адаптироваться к разным типам взаимодействий

## Эволюция в Pinterest

MultiBiSage стал частью эволюции рекомендательных систем в Pinterest:
- После PinSage → MultiBiSage → OmniSage → PinFM
- Каждый следующий этап добавлял новые возможности или упрощал архитектуру

## Связи с другими темами

- [[PinSage.md]] - Предшественник MultiBiSage
- [[Pixie.md]] - Метод, используемый для отбора соседей
- [[graph_neural_networks_for_recommendations.md]] - Общее описание GNN в рекомендациях
- [[pinnerformer_pinrec_architectures.md]] - Последующие архитектуры в Pinterest
- [[transformer_based_models.md]] - Использование трансформеров

## Источники

1. [MultiBiSage: Multi-Bipartite Graph Sage for Recommendations] - оригинальная статья о MultiBiSage
2. [Pinterest: от Pixie до PinFM] - эволюция рекомендательных систем в Pinterest, включая MultiBiSage
3. [Transformer-Based Models in Recommendation Systems] - применение трансформеров в рекомендательных системах
4. [Advanced Graph Neural Networks for Web-Scale Recommendations] - расширенные GNN для веб-масштабных рекомендаций