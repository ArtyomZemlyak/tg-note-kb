# NGCF: Neural Graph Collaborative Filtering

## Описание

Neural Graph Collaborative Filtering (NGCF) - это графовая нейронная сеть, специально разработанная для задач рекомендаций. Модель явно моделирует связи предпочтений пользователей, распространяя информацию о предпочтениях через структуру графа user-item взаимодействий.

## Основная идея

NGCF использует идею распространения информации о предпочтениях через граф:
- Если два пользователя взаимодействуют с похожими айтемами, они, вероятно, имеют схожие предпочтения
- Информация о предпочтениях пользователя распространяется через айтемы к другим пользователям
- Это позволяет выявлять сложные отношения между пользователями и айтемами

## Архитектура

### Message Passing

NGCF использует механизм передачи сообщений для распространения информации через граф:
1. Стартуем с обучаемых эмбеддингов вершин (пользователей и айтемов)
2. На каждом слое:
   - Делаем message passing от соседей к вершине
   - Агрегируем эмбеддинги соседей с прошлого слоя
   - Используется MLP для агрегации

### Операция CONVOLVE

- Для каждой вершины u агрегируются эмбеддинги соседей N(u)
- Используется функция: `h_u^{(l+1)} = MLP(h_u^(l)) + AGG({h_v^(l) | v ∈ N(u)})`
- Где AGG - функция агрегации (например, усреднение или суммирование)

### Финальное представление

- Финальный эмбеддинг вычисляется как конкатенация эмбеддингов со всех слоев
- Это позволяет сохранить информацию на разных уровнях связности

## Предсказание рейтинга

- Скор ребра (u, i) вычисляется как скалярное произведение финальных эмбеддингов
- Используется функция: `score(u, i) = h_u^T * h_i`
- Оптимизация: поднятие скоров существующих рёбер выше, чем у случайных пар

## Преимущества

- Явное моделирование структуры графа
- Учет связей более высокого порядка
- Возможность выявления сложных паттернов взаимодействий
- Сильная математическая основа

## Ограничения

- Может страдать от проблемы over-smoothing при глубоких сетях
- Популярные айтемы имеют много соседей, что может привести к дисбалансу
- Высокая вычислительная сложность на больших графах

## Связь с другими моделями

- **LightGCN**: упрощение NGCF без MLP-агрегаторов
- **GCN**: обобщение подхода Graph Convolutional Networks для рекомендаций

## Сравнение с LightGCN

- NGCF использует MLP в агрегации, LightGCN - простое усреднение
- NGCF имеет больше обучаемых параметров, LightGCN - меньше
- NGCF теоретически более мощный, но LightGCN часто показывает лучшие результаты на практике

## Связи с другими темами

- [[LightGCN.md]] - Упрощенная версия NGCF
- [[graph_neural_networks_for_recommendations.md]] - Общее описание GNN в рекомендациях
- [[traditional_approaches.md]] - Сравнение с традиционными подходами к рекомендациям
- [[gnn_architectures.md]] - Базовые архитектуры графовых нейронных сетей

## Источники

1. [NGCF: Neural Graph Collaborative Filtering] - оригинальная статья об архитектуре NGCF
2. [LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation] - сравнение с упрощённой версией
3. [Matrix Factorization Techniques for Recommender Systems] - контекст традиционных методов
4. [Stanford CS224W: GNNs for Recommender Systems] - лекции о применении GNN в рекомендательных системах