# DenseRec: Revisiting Dense Content Embeddings for Sequential Transformer-based Recommendation

## Описание

DenseRec - это архитектура рекомендательной системы, предложенная для решения проблем традиционных трансформерных моделей в рекомендательных системах. Метод объединяет контентные и коллаборативные эмбеддинги, чтобы эффективно обрабатывать как "тёплые" (часто взаимодействующиеся), так и "холодные" (новые/редкие) айтемы в динамических каталогах.

## Контекст и проблема

Трансформерные модели (вроде SASRec или HSTU) стали стандартом в рекомендательных системах. Однако у них есть ключевое слабое место: они должны выучивать уникальный эмбеддинг для каждого айтема в каталоге.

### Основные проблемы:
- **Статичность каталогов**: Хорошо работает для фиксированных каталогов, плохо - для динамичных, где айтемы часто добавляются
- **Проблема холодного старта**: Трудности с новыми айтемами, для которых нет достаточной истории взаимодействий
- **Неэффективность для редких айтемов**: Айтемы из "длинного хвоста" могут иметь слабые представления

Хотя контентные эмбеддинги (на основе текстовой информации о айтемах) могут решить проблему холодного старта, они хуже работают для "тёплых" айтемов, которые генерируют большую часть взаимодействий, по сравнению с коллаборативными эмбеддингами.

## Предложенное решение

DenseRec предлагает использовать **и контентные, и коллаборативные эмбеддинги одновременно**:

### На этапе обучения:
- Для каждого айтема модель вероятностно выбирает, какой эмбеддинг использовать - контентный или коллаборативный
- Модель учится эффективно работать с обоими типами представлений

### На этапе инференса:
- Для "тёплых" айтемов - используются выученные коллаборативные эмбеддинги
- Для "холодных" айтемов - используются контентные эмбеддинги

## Архитектура и реализация

### Ключевые особенности:
- Метод модифицирует **только слой эмбеддингов**, что позволяет легко интегрировать его в любую существующую модель
- Может быть интегрирован в существующие архитектуры (авторы использовали SASRec как основу)
- Обучение с вероятностным выбором типа эмбеддинга для каждого айтема

### Преимущества:
- Эффективное решение проблемы холодного старта
- Сохранение качества для "тёплых" айтемов за счет коллаборативных сигналов
- Простота интеграции в существующие пайплайны без значительного изменения архитектуры
- Практическая применимость как в исследовательских, так и в продуктовых системах

## Экспериментальные результаты

- Существенный прирост по метрикам на датасетах Amazon Reviews
- Успешное применение в продакшене (по сообщениям авторов в личной переписке)
- Улучшение метрик по сравнению с базовыми трансформерными моделями

## Сравнение с другими подходами

| Подход | Преимущества | Недостатки | Применимость |
|--------|--------------|------------|--------------|
| Коллаборативная фильтрация | Высокая точность для "тёплых" айтемов | Проблема холодного старта | Статичные каталоги |
| Контент-базированные методы | Решение проблемы холодного старта | Слабее для "тёплых" айтемов | Новые айтемы |
| DenseRec | Комбинирует преимущества, решает холодный старт и сохраняет качество | Более сложная архитектура эмбеддингов | Динамичные каталоги |

## Применение и реализация

DenseRec особенно полезен в:
- Платформах с динамичными каталогами (музыка, видео, товары)
- Системах с значительной долей айтемов из "длинного хвоста"
- Приложениях, где важно быстрое добавление новых айтемов без переобучения моделей
- Системах, где требуется баланс между точностью для известных айтемов и возможностью рекомендовать новые

## Литература и источники

- Оригинальная статья: "DenseRec Revisiting Dense Content Embeddings for Sequential Transformer-based Recommendation"
- Авторы: Jan Malte Lichtenberg, Antonio De Candia, Matteo Ruffini (Albatross.ai)
- Место публикации: EARL @RecSys 2025
- Примечание: Jan и Matteo - выходцы из Amazon Music

## Связи с другими темами

- [[transformer_based_models.md]] - Трансформерные модели в рекомендательных системах: контекст для понимания базовой проблемы
- [[traditional_approaches.md]] - Традиционные подходы к рекомендательным системам: основа для сравнения с классическими методами
- [[candidate_generation.md]] - Генерация кандидатов: этап, где могут использоваться DenseRec-эмбеддинги
- [[llm_based/main.md]] - LLM-базированные рекомендательные системы: альтернативный подход к решению подобных проблем