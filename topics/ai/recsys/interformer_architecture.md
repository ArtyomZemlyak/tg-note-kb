# InterFormer: Архитектура с динамическим чередованием признаков

## Описание

InterFormer - это компонент архитектуры GEM (и, возможно, других моделей), который реализует подход с динамическим чередованием обработки последовательных и непоследовательных признаков. Основная идея заключается в том, чтобы не сваливать все признаки в одну кучу и не "замыливать" сигналы от разных типов данных.

## Проблема

В традиционных архитектурах рекомендательных систем все признаки (и последовательные, как история действий пользователя, клики, просмотры, и непоследовательные, как локация, возраст, свойства рекламы) объединяются в единый вектор. Это может привести к:

- Потере важной информации из-за взаимного "затмения" разных типов признаков
- Снижению эффективности обработки специфичных паттернов в последовательных данных
- Ухудшению качества рекомендаций из-за "размытости" сигналов

## Архитектурное решение

InterFormer использует подход с динамическим чередованием:

1. **Обработка последовательных признаков**: Сначала последовательности событий обрабатываются кастомным трансформер-блоком
2. **Интеграция непоследовательных признаков**: Затем слой объединяет эти выходы со статичными признаками через cross-feature interaction-блоки
3. **Циклическая обработка**: Процесс повторяется на следующем уровне

## Преимущества

- **Сохранение "свежести" сигналов**: Разделение обработки позволяет сохранить специфичные паттерны в последовательных данных
- **Учет взаимодействий**: Cross-feature interaction-блоки обеспечивают учет связей между разными типами признаков
- **Гибкость**: Архитектура может адаптироваться к разным типам данных и сценариям использования
- **Улучшенная интерпретируемость**: Отдельные потоки обработки позволяют лучше понимать, как разные типы признаков влияют на рекомендации

## Сравнение с альтернативами

| Подход | Преимущества | Недостатки | Применение |
|--------|--------------|------------|------------|
| InterFormer | Сохранение информации, учет взаимодействий | Повышенная сложность | Комплексные рекомендательные системы с разными типами признаков |
| OneTrans | Одновременная обработка последовательных и не-последовательных признаков в единой архитектуре | Повышенная сложность | Промышленные рекомендательные системы с высокими требованиями к точности |
| Объединение признаков | Простота, унификация | Потеря информации | Простые системы, ограниченные типы данных |
| Параллельные потоки без интеграции | Сохранение специфичности | Отсутствие взаимодействий между типами | Сценарии, где признаки независимы |

## Использование в GEM

InterFormer является одной из трёх ключевых технических фишек архитектуры GEM, наряду с компонентом Wukong и пирамидальной параллельной структурой для длинных последовательностей.

## Связи с другими темами

- [[gem_model.md]] - GEM: основная архитектура, использующая InterFormer
- [[transformer_based_models.md]] - Трансформерные модели в системах рекомендаций: контекст для понимания трансформер-блоков
- [[traditional_approaches.md]] - Традиционные подходы: контраст с классическими методами объединения признаков
- [[wukong_component.md]] - Компонент Wukong: альтернативный подход к обработке взаимодействий признаков

## Источники

1. [Сообщение о GEM от @researchoshnaya](https://t.me/researchoshnaya) - описание компонента InterFormer как части архитектуры GEM от Meta