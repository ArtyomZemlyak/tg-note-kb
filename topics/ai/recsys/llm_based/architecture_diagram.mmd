graph TD
    A[Входные данные<br/>• История пользователя<br/>• Признаки пользователя<br/>• Признаки айтемов<br/>• Контекстные данные<br/>• Семантические ID ] --> B[Предобработка<br/>• Токенизация<br/>• Создание SIDs<br/>• Формирование промтов]
    
    B --> C{LLM Модель}
    
    C --> D[Семантические встраивания<br/>• Специальные встраивания для айтемов]
    C --> E[Многослойный Трансформер<br/>• Encoder-Decoder архитектура<br/>• Обработка последовательностей]
    C --> F[Механизм Внимания<br/>• Фокусировка на релевантных частях<br/>• Обработка зависимостей]
    
    D --> G[Выходной слой]
    E --> G
    F --> G
    
    G --> H[Выходные данные<br/>• Прогноз рекомендаций<br/>• Семантические ID<br/>• Объяснения<br/>• Контекстуальная информация]
    
    H --> I[Постобработка<br/>• Конвертация в рекомендации<br/>• Фильтрация<br/>• Переранжирование]
    
    I --> J[Финальные рекомендации<br/>• Айтемы для показа пользователю]

    style C fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    style D fill:#f3e5f5,stroke:#4a148c,stroke-width:1px
    style E fill:#e8f5e8,stroke:#1b5e20,stroke-width:1px
    style F fill:#fff3e0,stroke:#e65100,stroke-width:1px
    style G fill:#e0f2f1,stroke:#004d40,stroke-width:1px