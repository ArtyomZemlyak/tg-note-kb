# OneRec-Think (Kuaishou)

## Описание

OneRec-Think - это LLM-based рекомендательная система, разработанная компанией Kuaishou. Это одна из первых успешных реализаций подхода использования больших языковых моделей для рекомендательных задач с интеграцией семантических ID (SIDs) и ризонинга.

## Архитектура

### Основные компоненты

1. **Используемая LLM**: Qwen-8B
2. **Семантические ID (SIDs)**: Главное представление айтемов для модели
   - Строится на основе мульти-модальных контентных эмбеддингов
   - Включает коллаборативный сигнал из сервиса
   - Работает с видео-платформой

3. **Претрейн**:
   - Словарь LLM расширяется, чтобы включать каталог семантических ID
   - Дообучение на задаче Next Token Prediction
   - Интеграция SIDs в текстовое описание поведения пользователей
   - Вторая стадия претрейна включает задачу предсказания SEMANTIC ID айтема, который стоит порекомендовать пользователю

4. **Файнтюн**:
   - Весь фокус на ризонинге (логическом выводе)
   - Модель учит формировать обоснование, почему пользователь после заданной истории взаимодействовал с конкретным айтемом
   - Генерация обоснований улучшает качество рекомендаций, по аналогии с рассуждающими LLM

## Внедрение

- Модель внедрена в оффлайне из-за вычислительной сложности ризонинга
- Рассуждающая модель в оффлайне генерирует несколько возможных траекторий (reasoning path) пользователя
- Для каждой траектории генерируется несколько возможных префиксов из 2-х SIDs
- Финальный сет всех возможных префиксов используется рантаймовой OneRec моделью для генерации итоговых рекомендаций
- OneRec является end-2-end движком, стадии ранжирования дальше не следует, генерируются именно финальные рекомендации

## Особенности

- Доказывает полезность модели в сценарии диалога с пользователем
- Намечается персонализированный ассистент по рекомендациям

## Связи с другими темами

- [[../main.md]] - Общая информация о LLM-based рекомендательных системах
- [[ai/llm/models/qwen.md]] - Модель Qwen, использованная в системе
- [[ai/recsys/personalized_assistants.md]] - Потенциальное развитие системы как персонализированного ассистента