# OneRec-Think (Kuaishou)

## Описание

OneRec-Think - это LLM-based рекомендательная система, разработанная компанией Kuaishou. Это одна из первых успешных реализаций подхода использования больших языковых моделей для рекомендательных задач с интеграцией семантических ID (SIDs) и ризонинга. Система была представлена на CIKM'25, где члены core команды OneRec поделились деталями, которых нет в публикациях.

## Архитектура

### Основные компоненты

1. **Используемая LLM**: Qwen-8B
2. **Семантические ID (SIDs)**: Главное представление айтемов для модели
   - Строится на основе мульти-модальных контентных эмбеддингов
   - Включает коллаборативный сигнал из сервиса
   - Работает с видео-платформой

3. **Претрейн**:
   - Словарь LLM расширяется, чтобы включать каталог семантических ID
   - Дообучение на задаче Next Token Prediction
   - Интеграция SIDs в текстовое описание поведения пользователей
   - Вторая стадия претрейна включает задачу предсказания SEMANTIC ID айтема, который стоит порекомендовать пользователю

4. **Файнтюн**:
   - Весь фокус на ризонинге (логическом выводе)
   - Модель учит формировать обоснование, почему пользователь после заданной истории взаимодействовал с конкретным айтемом
   - Генерация обоснований улучшает качество рекомендаций, по аналогии с рассуждающими LLM

## Внедрение

- Модель внедрена в оффлайне из-за вычислительной сложности ризонинга
- Рассуждающая модель в оффлайне генерирует несколько возможных траекторий (reasoning path) пользователя
- Для каждой траектории генерируется несколько возможных префиксов из 2-х SIDs
- Финальный сет всех возможных префиксов используется рантаймовой OneRec моделью для генерации итоговых рекомендаций
- OneRec является end-2-end движком, стадии ранжирования дальше не следует, генерируются именно финальные рекомендации

## Особенности

- Доказывает полезность модели в сценарии диалога с пользователем
- Намечается персонализированный ассистент по рекомендациям
- Использование 200 GPU для построения semantic IDs, как сообщалось на CIKM'25

## Инфраструктурные вызовы

Как стало известно из информации, полученной на CIKM'25, западные команды, вдохновленные работой OneRec, пытаются нагнать, но сталкиваются с основными сложностями, лежащими в инфраструктуре. По опыту Яндекса и других компаний, инфраструктурная часть действительно непростая часть реализации таких end-to-end генеративных рекомендательных систем.

## Влияние на отрасль

OneRec-Think стал эталоном для других end-to-end генеративных рекомендательных систем и значительно повлиял на развитие этой области. Его успех побудил западные команды изучать и внедрять подобные подходы, хотя они сталкиваются с инфраструктурными сложностями.

## Связи с другими темами

- [[../main.md]] - Общая информация о LLM-based рекомендательных системах
- [[ai/llm/models/qwen.md]] - Модель Qwen, использованная в системе
- [[ai/recsys/personalized_assistants.md]] - Потенциальное развитие системы как персонализированного ассистента
- [[end_to_end_generative_recommendation_systems.md]] - End-to-end генеративные рекомендательные системы: подробности о влиянии и внедрении OneRec
- [[cikm_25.md]] - CIKM'25: конференция, на которой были представлены подробности о OneRec
- [[cikm_25_insights.md]] - Инсайды от CIKM'25: информация о core команде OneRec и деталях, полученных на конференции

## Источники

1. [OneRec-Think: LLM-based Recommendations from Kuaishou] - оригинальная публикация о системе OneRec-Think, разработанной Kuaishou
2. [CIKM'25 Conference: OneRec Core Team Insights] - информация, полученная от core команды OneRec на CIKM'25, включая детали архитектуры и инфраструктурные вызовы
3. [CIKM'25 Conference Report: GPU Usage for Semantic IDs] - информация о том, что для построения semantic IDs в OneRec использовали 200 GPU, полученная на CIKM'25
4. [CIKM'25 Conference Report: Western Teams Challenges] - информация о том, что западные команды сталкиваются с инфраструктурными сложностями при внедрении OneRec-подобных систем