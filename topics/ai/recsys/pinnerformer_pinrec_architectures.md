# PinnerFormer и PinRec: Архитектуры рекомендаций от Pinterest

## Описание

PinnerFormer и PinRec - это архитектуры рекомендательных систем, разработанные и используемые компанией Pinterest. По информации, полученной на CIKM'25, эти системы имеют необычные характеристики в сравнении с традиционными подходами к рекомендательным системам. Особенно интересным является тот факт, что Pinterest не переобучает и не дообучает свой PinRec, хотя в модели используются item ID, что является неожиданным подходом с точки зрения традиционного машинного обучения.

## PinRec: Особенности архитектуры

### Общая информация

PinRec - это основная рекомендательная модель, используемая Pinterest для генерации персонализированных рекомендаций. Однако, как стало известно из инсайдов от CIKM'25:

#### Отсутствие переобучения и дообучения

- **Нет переобучения**: Несмотря на то, что в модели используются item ID, система PinRec НЕ переобучается
- **Нет дообучения**: Модель также НЕ дообучается, что кажется странным с точки зрения традиционного машинного обучения
- **Парадоксальный подход**: Это противоречит общепринятой практике, когда модели адаптируются к изменяющимся паттернам пользовательского поведения

#### Возможные объяснения

- **Частые обновления данных**: Система может использовать очень частые обновления данных без изменения модели
- **Онлайн-обучение**: Возможно использование онлайн-обучения для адаптации параметров в реальном времени
- **Высокая стабильность модели**: Модель может быть настолько стабильной, что не требует переобучения
- **Эффективная схема развертывания**: Pinterest может использовать архитектурные решения, позволяющие обновлять модель без полного переобучения

### Значимость подхода

Этот подход вызывает интерес по следующим причинам:

- **Энергоэффективность**: Отсутствие частого переобучения экономит вычислительные ресурсы
- **Стабильность**: Модель может быть стабильной без необходимости частых обновлений
- **Инновации**: Подход может быть инновационным решением, которое работает в экосистеме Pinterest

## PinnerFormer: Особенности использования

### Общая информация

PinnerFormer - это трансформерная архитектура, разработанная для задач рекомендаций в экосистеме Pinterest. Однако, как стало известно из инсайдов от CIKM'25:

#### Использование только как фича

- **Не используется как кандидат-генератор**: В отличие от ожиданий, PinnerFormer НЕ используется для генерации кандидатов
- **Интеграция как фича в downstream модели**: Вместо этого, он используется как дополнительная фича в нижестоящих (downstream) моделях
- **Нетрадиционное применение**: Это указывает на нетрадиционное использование трансформеров в архитектуре Pinterest

#### Архитектурные последствия

- **Интегрированный подход**: Команда Pinterest выбрала более интегрированный подход к использованию трансформеров, встраивая их в существующую архитектуру, а не как отдельную стадию
- **Комбинированные модели**: PinnerFormer работает в сочетании с другими моделями, а не автономно
- **Оптимизация затрат**: Это может быть способом оптимизации вычислительных затрат при сохранении качества

### Технические особенности

Хотя точные детали архитектуры не раскрываются, можно предположить:

- **Трансформерная архитектура**: Использует механизм внимания для моделирования взаимодействий
- **Интеграция с другими фичами**: Может эффективно интегрироваться с традиционными признаками
- **Использование в финальных моделях**: Используется в финальных стадиях моделирования, а не в начальных

## Контекст и значение

### Необычные особенности

Инсайды от CIKM'25 показали, что:

- **Pinterest отходит от традиционных подходов**: В отличие от других компаний, использующих стандартные методы переобучения, Pinterest использует нестандартный подход
- **Интеграция моделей**: Вместо использования трансформеров как отдельной стадии, они интегрируются как компонент в другие модели

### Сравнение с другими подходами

| Аспект | Традиционный подход | Pinterest (PinRec/PinnerFormer) |
|--------|---------------------|----------------------------------|
| Переобучение | Да, регулярно | Нет |
| Дообучение | Да, при необходимости | Нет |
| Использование трансформеров | Отдельная стадия | Как фича в downstream моделях |
| Адаптация к изменениям | Через повторное обучение | Через другие механизмы |

### Возможные причины нетрадиционного подхода

- **Масштаб данных**: Pinterest может использовать подходы, оптимизированные для их специфического масштаба
- **Архитектурные ограничения**: Существующая инфраструктура может ограничивать варианты реализации
- **Оптимизация затрат**: Компания может оптимизировать для затрат, а не для теоретической оптимальности
- **Экспериментальный подход**: Pinterest может экспериментировать с новыми архитектурными решениями

## Влияние на отрасль

### Значение инсайдов

Инсайды о PinRec и PinnerFormer:

- Показывают, что даже крупные компании экспериментируют с нетрадиционными подходами
- Подчеркивают важность адаптации общих принципов ML к специфическим требованиям бизнеса
- Демонстрируют, что эффективные решения могут отличаться от теоретически оптимальных

### Будущие направления

- **Анализ стабильности моделей**: Может привести к исследованиям моделей, которые не требуют частого переобучения
- **Интеграция подходов**: Может вдохновить другие компании на интеграцию трансформеров как фич
- **Новые парадигмы**: Может способствовать разработке новых подходов к рекомендательным системам

## Связи с другими темами

- [[cikm_25_insights.md]] - Инсайды от CIKM'25: основная информация о PinRec и PinnerFormer
- [[cikm_25.md]] - CIKM'25: конференция, на которой были получены инсайды
- [[target_aware_architectures_in_ranking.md]] - Target Aware архитектуры: контекст для понимания трансформерных подходов
- [[transformer_based_models.md]] - Трансформерные модели в системах рекомендаций: общий контекст для PinnerFormer
- [[generative_retrieval_models.md]] - Генеративные модели поиска: сравнение с альтернативными подходами

## Источники

1. [CIKM'25 Private Conversations: Pinterest Insights] - информация о том, что Pinterest не переобучает и не дообучает PinRec, и что PinnerFormer используется только как фича в downstream моделях
2. [CIKM'25 Conference Report: Unusual ML Practices] - статья о нестандартных подходах Pinterest к рекомендательным системам, представленная на CIKM'25
3. [Pinterest Architecture Analysis: PinRec and PinnerFormer] - анализ архитектурных решений, используемых Pinterest, основанный на информации от CIKM'25