# Сессионные рекомендательные системы

## Описание

Сессионные рекомендательные системы - это подкатегория систем рекомендаций, которая фокусируется на предсказании следующего взаимодействия пользователя в рамках текущей сессии. В отличие от традиционных подходов, которые моделируют долгосрочные предпочтения пользователя, сессионные системы акцентируют внимание на краткосрочных интересах, проявленных в текущей сессии.

## Проблематика

### Традиционные подходы vs. сессионные сценарии

В традиционных рекомендательных системах предполагается, что история пользователя - это строгая последовательность событий. Однако в реальных e-commerce сценариях:
- Пользователь делает запрос и получает "пачку" товаров
- Внутри таких пачек никакой упорядоченности нет
- Обычные sequence-based подходы работают не полностью корректно

### Сессионное поведение

Сессионное поведение характеризуется:
- Краткосрочными интересами, которые могут быть нестабильными
- Быстрыми изменениями предпочтений в рамках одной сессии
- Влиянием контекста и текущего намерения пользователя

## Основные подходы

### 1. Next-Session Prediction

Подход, используемый в TBGRecall, где модель обучается предсказывать, какие товары пользователь увидит в следующей выдаче.

На конференции CIKM'25 2025 была представлена работа "Taming Ultra-Long Behavior Sequence in Session-wise Generative Recommendation", расширяющая этот подход для учета очень длинной истории поведения пользователя (до 100,000 айтемов) в сжатом виде, чтобы учитывать долгосрочные интересы в сессионных рекомендациях. Также на CIKM'25 была представлена работа TBGRecall, расширяющая возможности генеративных моделей для сессионных рекомендаций.

### 2. Sequential Pattern Mining

Техники, направленные на выявление паттернов в последовательностях действий пользователя в рамках сессии.

### 3. Session-Aware Neural Models

Нейронные архитектуры, явно моделирующие сессионное поведение:
- RNN-based модели для сессий
- Transformer-модели с сессионной структурой
- Графовые модели для сессий

## Ключевые техники

### Маскирование внимания

- Внутри-сессионная маска предотвращает "просмотр" айтемов внутри одной сессии друг на друга
- Позволяет модели корректно обрабатывать неупорядоченные множества товаров

### Session-wise Positional Embeddings

- Использование специальных позиционных вложений для кодирования сессий
- Пример: sw-ROPE (Session-wise Rotary Positional Embeddings) в TBGRecall

### Контекстные токены

- Использование специальных токенов для представления контекста сессии
- Позволяют модели учитывать запросы и намерения пользователя

## Архитектуры

### Традиционные подходы

- Session-Based Matrix Factorization (SBMF)
- FPMC (Factorizing Personalized Markov Chains)
- Session-Aware Collaborative Filtering

### Глубокие подходы

- GRU4Rec (RNN-based)
- NARM (Neural Attentive Session-based Recommendation)
- STAMP (Short-Term Attention/Memory Priority)
- SASRec (Self-Attentive Sequential Recommendation) с адаптациями
- TBGRecall - генеративный подход

## Метрики оценки

Для сессионных рекомендательных систем используются специфические метрики:

- **Session Recall@K**: Доля сессий, в которых хотя бы один релевантный айтем попал в топ-K
- **Session Hit Rate@K**: Показатель "попадания" релевантного айтема в топ-K для сессий
- **Session MRR**: Среднее обратное ранжирование для сессий
- **NDCG@K по сессиям**: Нормализованный кумулятивный выигрыш по сессиям

## Применение

Сессионные рекомендательные системы находят применение в:

- Поисковых системах
- Рекламных платформах
- E-commerce приложениях
- Музыкальных и видео-платформах
- Новостных агрегаторах

## Связи с другими темами

- [[tbgrecall.md]] - TBGRecall: современный подход к сессионным рекомендациям
- [[candidate_generation.md]] - Генерация кандидатов: этап, где могут использоваться сессионные подходы
- [[transformer_based_models.md]] - Трансформерные модели: основа для современных сессионных архитектур
- [[traditional_approaches.md]] - Традиционные подходы: контекст для сравнения
- [[sw_rope.md]] - Session-wise ROPE: техника для моделирования сессий
- [[optimization/incremental_learning.md]] - Инкрементальное обучение: для поддержания актуальности сессионных моделей
- [[cikm_25.md]] - CIKM'25: конференция, на которой представлены последние продвижения в сессионных рекомендательных системах

## Источники

1. [Next-Session Prediction Approaches in Session-Based Recommendations] - обзор подходов к next-session prediction, включая TBGRecall
2. [CIKM'25 Conference Report: Session Recommendation Advances] - статья о новых подходах к сессионным рекомендациям, представленных на конференции CIKM'25, включая работу по taming ultra-long behavior sequence