# Session-wise Rotary Positional Embeddings (sw-ROPE) в рекомендательных системах

## Описание

Session-wise Rotary Positional Embeddings (sw-ROPE) - это модификация традиционных вращательных позиционных вложений (RoPE), адаптированная для сессионных рекомендательных систем. В отличие от стандартного RoPE, который кодирует позиции внутри последовательности, sw-ROPE кодирует позиции отдельных сессий пользователя.

## Применение в TBGRecall

В контексте TBGRecall sw-ROPE используется для моделирования сессий пользователя как отдельных единиц, где каждая сессия представляет собой один запрос с возвращаемыми товарами. Это позволяет модели различать и учитывать порядок сессий, а не только порядок айтемов внутри одной сессии.

### Архитектурная интеграция

- sw-ROPE применяется на уровне сессий, а не отдельных айтемов
- Позволяет модели захватывать долгосрочную эволюцию интересов пользователя через сессии
- Комбинируется с внутри-сессионной маской внимания, предотвращающей "просмотр" айтемов внутри сессии друг на друга

## Преимущества

1. **Моделирование сессий**: Позволяет эффективно моделировать сессии как атомарные единицы взаимодействия
2. **Долгосрочные зависимости**: Улавливает эволюцию интересов пользователя через сессии
3. **Контекстуальное понимание**: Помогает модели понимать, как контекст и запросы пользователя меняются со временем

## Технические детали

sw-ROPE модифицирует стандартный RoPE для учета иерархии сессий:
- Каждая сессия получает собственное позиционное кодирование
- Внутри сессии айтемы могут использовать традиционное позиционное кодирование или быть обработаны как неупорядоченное множество (см. маскирование внимания)

## Сравнение с традиционными подходами

| Аспект | sw-ROPE | Традиционный RoPE | Без позиционных вложений |
|--------|---------|-------------------|---------------------------|
| Моделирование сессий | + (сессия как единица) | - (айтем как единица) | - |
| Учет сессионной структуры | Полное | Ограниченное | Отсутствует |
| Сложность | Средняя | Низкая | Низкая |

## Связи с другими темами

- [[tbgrecall.md]] - TBGRecall: основная модель, использующая sw-ROPE
- [[session_based_recommendations.md]] - Сессионные рекомендательные системы: контекст применения sw-ROPE
- [[transformer_based_models.md]] - Трансформерные модели: контекст для понимания RoPE
- [[candidate_generation.md]] - Генерация кандидатов: сессионный контекст важен при генерации
- [[traditional_approaches.md]] - Традиционные подходы: для сравнения с классическими методами