# Target Aware архитектуры в ранжировании

## Описание

Target Aware архитектуры в ранжировании - это новое направление в архитектуре моделей ранжирования рекомендательных систем, при котором используется раннее связывание с историей пользователя и кандидатами. Эти архитектуры переходят от классических deep ranker моделей, основанных на взаимодействии признаков (feature interaction), к моделям, которые используют сырую историю событий как вход и подставляют как историю, так и кандидата в механизме внимания.

## Ключевые архитектуры

### InterFormer

InterFormer уже представлен в базе знаний как компонент архитектуры GEM, который реализует подход с динамическим чередованием обработки последовательных и непоследовательных признаков. В контексте Target Aware архитектур, InterFormer позволяет более эффективно интегрировать историю пользователя с кандидатами.

### RankMixer

RankMixer - это архитектура, разработанная для эффективного ранжирования с использованием механизма внимания, где кандидаты напрямую взаимодействуют с историей поведения пользователя. Основная идея заключается в том, чтобы использовать сырую историю событий как вход в модель и позволить вниманию учитывать как историю, так и кандидата при формировании предсказания.

### MTGR (Multi-Task Graph Recommender)

MTGR - это графовая рекомендательная система, которая использует мультизадачный подход для моделирования взаимодействий между пользователем, кандидатами и историей. В отличие от традиционных подходов, MTGR учитывает графовую структуру взаимодействий на ранних этапах обработки, что позволяет более эффективно связывать таргет с историей пользователя.

### TransAct V2

TransAct V2 - это улучшенная версия архитектуры, которая использует трансформер для моделирования последовательностей поведения пользователя и одновременно учитывает кандидатов. Согласно информации с CIKM'25, TransAct V2 переобучают раз в неделю, но со случайных весов, что позволяет поддерживать актуальность модели при изменении паттернов поведения пользователей.

## Общая идея Target Aware подходов

- **Использование сырой истории событий как входа**: В отличие от традиционных подходов, где история предварительно обрабатывается в фиксированные признаки, Target Aware архитектуры используют сырую последовательность событий
- **Раннее связывание с кандидатами**: Кандидат (или несколько кандидатов в виде токенов) подставляется в механизм внимания на ранних этапах, позволяя модели напрямую моделировать отношения между историей и кандидатом
- **Сохранение классических ручных признаков**: Несмотря на использование новых подходов, эти архитектуры сохраняют важные традиционные признаки для стабильности и интерпретируемости

## Преимущества Target Aware архитектур

1. **Более точное моделирование**: Позволяет моделировать сложные взаимосвязи между историей пользователя и кандидатами
2. **Гибкость**: Могут адаптироваться к различным паттернам поведения пользователей
3. **Контекстуальность**: Лучше учитывают контекст взаимодействия кандидата с историей

## Связь с CIKM'25

На CIKM'25 был представлен тренд на Target Aware архитектуры в ранжировании, который показал, что крупные компании переходят от классических deep ranker архитектур к этим новым моделям. Компании в Яндексе тоже внедряют такие модели, как подтверждает информация от Пети Зайделя из команды Музыки на PML'25.

## Связи с другими темами

- [[interformer_architecture.md]] - InterFormer: компонент архитектуры, реализующий динамическое чередование признаков
- [[transformer_based_models.md]] - Трансформерные модели в системах рекомендаций: контекст для понимания архитектур на основе трансформеров
- [[cikm_25.md]] - CIKM'25: конференция, на которой были представлены последние продвижения в Target Aware архитектурах
- [[yandex_music_team.md]] - Команда Яндекс.Музыки: информация о внедрении Target Aware моделей

## Источники

1. [CIKM'25 Conference Report: Target Aware Architectures] - статья о тренде на Target Aware архитектуры в ранжировании, представленная на CIKM'25, описывающая переход от традиционных deep ranker моделей к моделям с использованием раннего связывания с историей пользователя
2. [PML'25 Conference: Yandex Music Team] - доклад Пети Зайделя из команды Яндекс.Музыки о внедрении Target Aware моделей в промышленной среде