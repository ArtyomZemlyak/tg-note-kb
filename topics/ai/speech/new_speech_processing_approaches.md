# Новые подходы к обработке речи: интонационный споттер, MASV и оптимизация памяти

## Краткое описание

Три новых подхода к обработке речи: активация устройства без специального слова (интонационный споттер от Apple), новая архитектура для верификации спикера (MASV от Meta) и необычный подход к оптимизации памяти для акустических моделей.

## Интонационный споттер (Apple)

Интонационный споттер от Apple — модель на 5 млн параметров, способная по интонации определять, когда человек обращается к устройству (например, колонке). Авторы утверждают, что она уже используется на некоторых смартфонах, и в настоящее время ведётся работа над версией для колонок.

### Особенности:
- Обучение на нескольких сотнях тысяч размеченных сэмплов и дополнительных псевдолейблах
- Одновременное обучение общей основы для трёх споттеров: "Hey Siri", "Siri" и интонационного
- Это позволяет существенно увеличить качество модели на всех трёх задачах
- Трёхуровневая дистилляция с ASR (Adaptive Knowledge Distillation)
- Ученик — конформер с тремя адаптерами для споттеров
- Учитель — ASR на 80 млн параметров, 12 conformer-слоёв и энкодер

## MASV: Верификация спикера с глобальным и локальным контекстом (Mamba)

MASV (Meta Audio Speaker Verification) — стриминговая модель верификации голоса для смарт-очков от Meta, которая представляет новую архитектуру, объединяющую блоки ECAPA-TDNN с Mamba-модулем.

### Особенности:
- Комбинация позволяет учитывать как локальные, так и глобальные зависимости
- Остается достаточно лёгкой для работы на устройствах с ограниченными ресурсами
- Поддерживает обработку длинных аудиовходов
- Модель оценивалась на внутренних данных: студийная запись около 5 млн высказываний от 30 тысяч человек
- Высокое качество на внутренних данных, но результаты могут быть нерепрезентативными для реальных сценариев использования смарт-очков

## Сжатие Conformer и речевых основных моделей с эффективным использованием памяти

Необычный подход к оптимизации памяти, потребляемой моделью во время инференса. Вместо хранения десятков отдельных слоёв, авторы обучают небольшой трансформер с несколькими блоками так, чтобы одни и те же слои можно было последовательно использовать несколько раз.

### Особенности:
- На инференсе даёт логически более глубокую сеть без добавления новых параметров
- Большую модель и её варианты с разной логической глубиной тренируют совместно в одном цикле
- Для выравнивания поведения добавляют самодистилляцию: минимизируют KL-дивергенцию между самой глубокой и самой короткой конфигурациями
- Качество компактной модели заметно уступает исходной глубокой архитектуре
- При логическом дублировании слоёв (многократном прохождении через одни и те же блоки) сжатая модель практически догоняет большую, при этом потребляя меньше памяти

## Новые концепции и термины

- **Интонационный споттер**: Модель, определяющая по интонации, когда человек обращается к устройству без использования ключевых слов
- **MASV (Meta Audio Speaker Verification)**: Новая архитектура верификации спикера, объединяющая ECAPA-TDNN и Mamba
- **Adaptive Knowledge Distillation**: Метод дистилляции знаний, применяемый на нескольких уровнях для обучения нескольких специализированных моделей на общей основе
- **ECAPA-TDNN**: Архитектура для задач верификации спикера
- **Mamba**: State Space Model, применяемая для обработки последовательностей, включая аудио
- **Логическая глубина**: Концепция, при которой одни и те же слои используются многократно для создания логически более глубокой сети

## Примеры применения

- **Интонационный споттер**: Использование в устройствах, где требуется определить, обращается ли пользователь к устройству, без использования ключевых слов активации
- **MASV**: Верификация голоса в носимых устройствах, таких как смарт-очки
- **Сжатие Conformer**: Развертывание больших акустических моделей на устройствах с ограниченной памятью

## Связи с другими темами

- [[asr/speech_recognition.md]] - Общие принципы распознавания речи
- [[../state_space_models.md]] - Теоретическая основа для Mamba-архитектур
- [[../llm/models/audio_mamba.md]] - Audio Mamba, архитектура, также использующая Mamba для аудиообработки
- [[vqe_voice_quality_enhancement_sber_smart_speakers.md]] - Другой аспект обработки речи для умных колонок
- [[sber_smart_speaker_audio_quality_assessment.md]] - Оценка качества аудио в устройствах

## Источники

1. [Три статьи о новых подходах к обработке речи] - Оригинальный материал о новых подходах к обработке речи, включая интонационный споттер, MASV и оптимизацию памяти, представленный Борисом Шелудько для Speech Info