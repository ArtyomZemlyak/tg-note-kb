# Гипотеза линейности в нейронных сетях

## Общее описание

Гипотеза линейности - концепция в машинном обучении и искусственном интеллекте, согласно которой представления в нейронных сетях, особенно в больших языковых моделях, обладают линейными свойствами. Это означает, что определенные понятия (concept) могут быть представлены как направления в векторном пространстве, и отношения между понятиями могут быть выражены через линейные операции.

## Исторические корни

Гипотеза линейности восходит к работе "Linguistic Regularities in Continuous Space Word Representations", где были впервые продемонстрированы линейные закономерности в векторных представлениях слов. Классический пример - векторная арифметика:

```
vector("King") - vector("Man") + vector("Woman") ≈ vector("Queen")
```

Этот пример показывает, что гендерные отношения могут быть выражены через линейные операции над векторами слов.

## Современные применения

### 1. LIME (Local Interpretable Model-agnostic Explanations)

LIME объясняет предсказания сложных моделей как локальную линейную аппроксимацию функции в окрестности точки. Это позволяет выделить наиболее важные признаки для конкретного прогноза.

### 2. Разреженные автоэнкодеры (SAE)

SAE (Sparse Autoencoders) представляют эмбеддинги как разреженные линейные комбинации базисных функций. Это позволяет извлекать интерпретируемые признаки из нейронных сетей, где только небольшое подмножество признаков активируется для любого конкретного ввода.

### 3. Оценка мнения модели через линейные зонды

Мнение модели (model beliefs) оценивается с помощью линейных классификаторов, обученных на резидуальных потоках (residual stream). Это позволяет понять, какая информация содержится на разных уровнях глубокой нейронной сети.

### 4. Интерпретируемые концепции и линейные преобразования

Концепты могут быть выражены в виде линейной комбинации признаков. В частности, было показано, что существует линейное (и ортогональное) преобразование между представлениями больших моделей. Например, можно взять концепт в GPT-J, линейно перенести его в LLaMA, и он продолжает быть справедливым.

## Преимущества линейного подхода

- **Интерпретируемость**: Линейные представления легче интерпретировать и анализировать
- **Переносимость**: Концепты могут быть перенесены между моделями через линейные преобразования
- **Арифметические свойства**: Позволяет использовать векторную арифметику для манипуляций с понятиями
- **Математическая обоснованность**: Линейные операции обладают хорошими математическими свойствами

## Ограничения и вызовы

- **Нелинейные взаимодействия**: Нелинейные взаимодействия между признаками никуда не исчезают и могут мешать линейным аппроксимациям
- **Полисемия нейронов**: Один нейрон может кодировать несколько смыслов, что ухудшает интерпретацию линейных направлений
- **Требуется разреживание или ортогонализация**: Для выделения чистых направлений требуются дополнительные процедуры

## Связи с другими темами

- [[../mechanistic_interpretability.md|Механистическая интерпретируемость]] - Обе темы исследуют внутренние представления и работу нейронных сетей
- [[linear_sequence_modeling.md|Линейное моделирование последовательностей]] - Соседняя тема, изучающая линейные вычисления, но с акцентом на вычислительную сложность
- [[nlp/word_embeddings.md|Векторные представления слов]] - Исторические основы линейных отношений в эмбеддингах

## Примеры применения

- Интерпретация внутренних представлений LLM
- Перенос знаний между моделями
- Обнаружение и анализ предвзятостей в моделях
- Создание объяснений для решений модели

## Недавние разработки

Исследования продолжают выявлять линейные структуры в самых разных архитектурах моделей, что указывает на фундаментальный характер этой гипотезы. Развитие идёт как в теоретическом понимании, так и в практических приложениях линейных методов анализа моделей.

## Источники и ссылки

- Mikolov, T., et al. (2013). Linguistic Regularities in Continuous Space Word Representations
- Современные работы по интерпретируемости и линейной арифметике в LLM