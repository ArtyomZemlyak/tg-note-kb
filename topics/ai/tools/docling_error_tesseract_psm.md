# Ошибка TesseractOcrOptions в Docling: отсутствует поле psm

## Описание проблемы

Ошибка `convert_document_into_docling_document: Unexpected error: "TesseractOcrOptions" object has no field "psm"` возникает при использовании библиотеки Docling для обработки документов с включенным OCR. Эта проблема указывает на то, что в используемой версии библиотеки поле `psm` (Page Segmentation Mode) было изменено, удалено или никогда не существовало в классе `TesseractOcrOptions`.

Термин `psm` (Page Segmentation Mode) - это важный параметр в Tesseract OCR, который определяет, как распознаватель интерпретирует структуру страницы: как блоки текста, строки, слова или отдельные символы. Правильная настройка PSM может значительно повысить точность распознавания в зависимости от типа изображения документа.

## Причины возникновения

1. **Изменение API**: Разработчики Docling могли изменить структуру класса `TesseractOcrOptions` в новой версии
2. **Использование устаревшего кода**: Примеры или документация могут содержать устаревшие параметры
3. **Несовместимость версий**: Используется несовместимая версия библиотеки с существующим кодом
4. **Неправильная конфигурация**: Попытка доступа к несуществующему полю в TesseractOcrOptions
5. **Изменения в интеграции Tesseract**: Параметры Tesseract были переименованы или реорганизованы внутри Docling

## Решение проблемы

Для исправления этой ошибки, попробуйте следующие подходы:

1. **Проверьте документацию**: Ознакомьтесь с официальной документацией текущей версии Docling
2. **Альтернативные параметры**: Используйте вместо `psm` другие доступные параметры:
   - `ocr_options` - для настройки параметров OCR
   - `tesseract_config` - если таковой параметр существует
   - `ocr_mode` или `ocr_method` - для выбора метода OCR
3. **Обновление кода**: Обновите свой код в соответствии с текущим API
4. **Проверка версии**: Убедитесь, что вы используете совместимую версию библиотеки
5. **Проверка конфигурации**: Убедитесь, что вы правильно создаете объект настроек OCR

## Пример фикса

Вместо:
```python
from docling.datamodel.document import TesseractOcrOptions

options = TesseractOcrOptions(psm=6)
```

Используйте:
```python
from docling.datamodel.document import OCRConfig

# Проверьте доступные параметры в документации
# Возможно, нужно использовать OCRConfig с другими параметрами
config = OCRConfig(do_ocr=True)  # или другие доступные параметры
```

## Параметр PSM в Tesseract OCR

Для полноты картины, PSM (Page Segmentation Mode) в оригинальном Tesseract OCR может принимать следующие значения:

- `0` - Только определение ориентации и скрипта (OSD)
- `1` - Автоматическая сегментация страницы с OSD
- `2` - Автоматическая сегментация, без OSD и OCR
- `3` - Полностью автоматическая сегментация (по умолчанию)
- `4` - Одна колонка текста с переменным размером
- `5` - Один равномерный блок вертикально выровненного текста
- `6` - Один равномерный блок текста
- `7` - Обработка изображения как одной строки текста
- `8` - Обработка изображения как одного слова
- `9` - Обработка изображения как одного слова в круге
- `10` - Обработка изображения как одного символа
- `11` - Разреженный текст (находит весь возможный текст без учета порядка)
- `12` - Разреженный текст с OSD
- `13` - Сырая строка (обрабатывает как одну строку, без Tesseract-специфичных хаков)

## Связь с другими темами

- [[docling.md]] - Общая информация о библиотеке Docling
- [[docling_error_ocrconfig.md]] - Описание аналогичной ошибки с OCRConfig
- [[docling_error_pdfpipelineoptions.md]] - Описание ошибки с PdfPipelineOptions
- [[../ocr/chandra_ocr.md]] - Современные альтернативы OCR
- [[../ocr/deepseek_ocr.md]] - Другие решения для OCR

## Источники

1. [Документация Tesseract OCR](https://tesseract-ocr.github.io/tessdoc/ImproveQuality.html) - официальная документация Tesseract OCR с описанием параметра PSM (Page Segmentation Mode)
2. [Официальный репозиторий Docling на GitHub](https://github.com/DS4SD/docling) - основной репозиторий библиотеки Docling, где можно найти актуальную документацию и примеры использования
3. [Документация Docling](https://ds4sd.github.io/docling/) - официальная документация библиотеки с описанием API и примерами