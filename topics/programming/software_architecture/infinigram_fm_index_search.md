# Infini-gram и FM-Index: Поиск n-грамм на масштабе интернета

## Краткое описание

Infini-gram - это система для точного поиска n-грамм в сверхбольших текстовых корпусах, использующая FM-Index (Full Text Minute Index). Была представлена в статье "Infini-gram mini: Exact n-gram Search at the Internet Scale with FM-Index", ставшей лучшей статьей на EMNLP2025. В отличие от традиционных подходов, таких как BM25 и SPLADE, Infini-gram использует структуру данных суффиксного массива для обработки n-грамм практически неограниченной длины с низкой задержкой.

## Постановка задачи

Языковые модели обучаются на огромных объемах текстовых данных из интернета, и важно понимать эти данные. Точный поиск по таким корпусам позволяет подсчитывать вхождения строк и находить исходные документы, но существующие системы не справляются с большими масштабами данных из-за высоких требований к хранилищу. Infini-gram решает проблему создания эффективной и масштабируемой системы для петабайтных текстовых корпусов, доступных для поиска.

## Основная идея алгоритма

Основная идея алгоритма заключается в использовании FM-Index (Full Text Minute Index), разработанного Феррагиной и Манзини, который одновременно индексирует и сжимает текст. Алгоритм обеспечивает:

1. **Эффективность**: Infini-gram mini значительно улучшает существующие реализации FM-Index. Размер индекса составляет всего 44% от исходного корпуса.
2. **Производительность**: 
   - Скорость индексации повышается в 18 раз
   - Использование памяти в процессе индексации сокращается в 3.2 раза
   - Потребление памяти при выполнении запросов снижается до незначительного уровня

## Технические детали

### FM-Index (Full Text Minute Index)

FM-Index - это структура данных для сжатого полнотекстового индексирования, разработанная Paolo Ferragina и Giovanni Manzini. Она позволяет эффективно выполнять поиск подстрок в сжатом виде, используя концепции суффиксных массивов и Burrows-Wheeler Transform (BWT).

### Ключевая инновация

Ключевая инновация Infini-gram - отказ от классических таблиц n-грамм в пользу суффиксного массива всего корпуса текстов. В отличие от традиционных языковых моделей n-грамм, которые используют заранее вычисленные таблицы частот, Infini-gram использует динамическую структуру данных, позволяющую обрабатывать n-граммы практически неограниченной длины с низкой задержкой.

### Решение проблемы традиционных n-грамм

Традиционные n-граммные модели имеют проблему при работе с большими значениями n: таблицы частот становятся астрономически большими. Например, для корпуса в 1.4 триллиона токенов 5-граммная таблица заняла бы около 28 ТБ, что делает модели с большим n невозможными. Infini-gram решает эту проблему, используя суффиксные массивы вместо предвычисленных таблиц.

## Применение

### RAG системы

Infini-gram может использоваться в RAG (Retrieval-Augmented Generation) системах с учетом BM25 индексов и других (например, SPLADE), обеспечивая более точный поиск n-грамм в больших корпусах данных.

### Системы памяти для агентов

Недавно появилась возможность использовать встроенный в файловую систему поиск для эффективной работы RAG и памяти. Подход с Infini-gram и FM-Index может быть полезен для агентных систем с памятью в качестве альтернативы поиска по большим массивам данных.

### Фильтрация больших датасетов

Технология может применяться для точной фильтрации больших наборов данных, позволяя находить и анализировать точные вхождения последовательностей текста.

## Преимущества

1. **Экономия пространства**: Индекс занимает всего 44% от размера исходного корпуса
2. **Высокая производительность**: 18x быстрее при индексации
3. **Экономия памяти**: 3.2x меньше использования памяти при индексации
4. **Масштабируемость**: Поддержка n-грамм практически неограниченной длины
5. **Точность**: Обеспечивает точный поиск n-грамм в отличие от вероятностных методов

## Сравнение с другими подходами

### BM25
- BM25 - вероятностная модель релевантности, улучшенная версия TF-IDF
- Использует частоты терминов и нормализацию по длине документа
- Infini-gram - точный метод поиска n-грамм в текстовых корпусах
- BM25 используется для оценки релевантности, Infini-gram - для точного поиска подстрок
- См. также: [[bm25_search_algorithm.md]]

### SPLADE
- SPLADE - это подход к поиску с разреженными представлениями
- Оба метода могут быть альтернативами траденциальным методам поиска
- Infini-gram фокусируется на точном поиске n-грамм, SPLADE - на разреженных представлениях документов
- См. также: [[search_methods_comparison.md]] для подробного сравнения методов

## См. также

- [[bm25_search_algorithm.md]] - классический алгоритм поиска BM25
- [[search_methods_comparison.md]] - сравнение различных методов поиска

## Источники

1. Описание статьи "Infini-gram mini: Exact n-gram Search at the Internet Scale with FM-Index" - информация основана на описании научной работы, которая была отмечена как лучшая статья на EMNLP2025 (предстоящая конференция). Статья описывает систему для точного поиска n-грамм в сверхбольших текстовых корпусах с использованием FM-Index.

## Дополнительные материалы

1. [FM-Index - Wikipedia](https://en.wikipedia.org/wiki/FM_index) - статья в Википедии об индексе FM, структуре данных для сжатого полнотекстового индексирования, разработанной Paolo Ferragina и Giovanni Manzini
2. [Suffix Array - Wikipedia](https://en.wikipedia.org/wiki/Suffix_array) - информация о суффиксных массивах, структуре данных, используемой в Infini-gram
3. [EMNLP 2025 Conference](https://2025.emnlp.org/) - официальный сайт конференции EMNLP 2025, где была представлена статья